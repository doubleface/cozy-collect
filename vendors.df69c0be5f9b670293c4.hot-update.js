webpackHotUpdate("vendors",{

/***/ "./node_modules/cozy-harvest-lib/dist/models/ConnectionFlow.js":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createOrUpdateAccount\", function() { return createOrUpdateAccount; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ConnectionFlow\", function() { return ConnectionFlow; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./node_modules/@babel/runtime/helpers/asyncToGenerator.js\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./node_modules/@babel/runtime/helpers/defineProperty.js\");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var microee__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"./node_modules/microee/index.js\");\n/* harmony import */ var microee__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(microee__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var cozy_realtime__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"./node_modules/cozy-realtime/dist/index.browser.js\");\n/* harmony import */ var cozy_realtime__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(cozy_realtime__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var cozy_flags__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"./node_modules/cozy-flags/dist/index.browser.js\");\n/* harmony import */ var cozy_flags__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(cozy_flags__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _connections_accounts__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/connections/accounts.js\");\n/* harmony import */ var lodash_clone__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(\"./node_modules/lodash/clone.js\");\n/* harmony import */ var lodash_clone__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(lodash_clone__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var lodash_get__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(\"./node_modules/lodash/get.js\");\n/* harmony import */ var lodash_get__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(lodash_get__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var _connections_triggers__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/connections/triggers.js\");\n/* harmony import */ var _helpers_konnectors__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/helpers/konnectors.js\");\n/* harmony import */ var _models_konnector_KonnectorJobWatcher__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/models/konnector/KonnectorJobWatcher.js\");\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/logger.js\");\n/* harmony import */ var _konnector_policies__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/konnector-policies.js\");\n/* harmony import */ var _models_cipherUtils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/models/cipherUtils.js\");\n/* harmony import */ var _assert__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/assert.js\");\n/* harmony import */ var _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/helpers/accounts.js\");\n/* harmony import */ var _helpers_triggers__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/helpers/triggers.js\");\n/* harmony import */ var _sentry__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/sentry.js\");\n/* harmony import */ var _flowEvents__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(\"./node_modules/cozy-harvest-lib/dist/models/flowEvents.js\");\n\n\n\n\n\n\nvar _eventToStatus;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar JOBS_DOCTYPE = \"io.cozy.jobs\";\nvar eventToStatus = (_eventToStatus = {}, _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default()(_eventToStatus, _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"ERROR_EVENT\"], _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"ERRORED\"]), _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default()(_eventToStatus, _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"LOGIN_SUCCESS_EVENT\"], _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"LOGIN_SUCCESS\"]), _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default()(_eventToStatus, _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"SUCCESS_EVENT\"], _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"SUCCESS\"]), _eventToStatus);\nvar stepEvents = [_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"LOGIN_SUCCESS_EVENT\"]];\n\nvar isStepEvent = function isStepEvent(eventName) {\n  return stepEvents.includes(eventName);\n};\n/**\n * Creates or updates an io.cozy.accounts from user submitted data\n * Used as a form submit handler\n *\n * @param  {io.cozy.account} options.account - Existing io.cozy.account or object\n * @param  {Cipher} options.cipher - Vault cipher if vault has been unlocked\n * @param  {CozyClient} options.client - A cozy client\n * @param  {io.cozy.konnector} options.konnector - Konnector to which the account is linked\n * @param  {KonnectorPolicy} options.konnectorPolicy - Controls if auth is saved in io.cozy.accounts\n * and if auth is saved into the vault\n * @param  {function} options.saveAccount\n * @param  {object} options.userCredentials\n */\n\n\nvar createOrUpdateAccount = /*#__PURE__*/function () {\n  var _ref2 = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee(_ref) {\n    var account, cipher, client, flow, konnector, konnectorPolicy, userCredentials, isUpdate, onAccountCreation, saveInVault, accountToSave, recycableAccount;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            account = _ref.account, cipher = _ref.cipher, client = _ref.client, flow = _ref.flow, konnector = _ref.konnector, konnectorPolicy = _ref.konnectorPolicy, userCredentials = _ref.userCredentials;\n            Object(_assert__WEBPACK_IMPORTED_MODULE_17__[\"default\"])(flow, \"No flow\");\n            isUpdate = !!account;\n\n            if (isUpdate) {\n              _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"Updating the account...\");\n            } else {\n              _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"Creating the account...\");\n            }\n\n            onAccountCreation = konnectorPolicy.onAccountCreation, saveInVault = konnectorPolicy.saveInVault;\n            accountToSave = lodash_clone__WEBPACK_IMPORTED_MODULE_9___default()(account) || {};\n            accountToSave = _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"resetState\"](accountToSave);\n            accountToSave = _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"setSessionResetIfNecessary\"](accountToSave, userCredentials);\n\n            if (!isUpdate) {\n              _context.next = 12;\n              break;\n            }\n\n            accountToSave = _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"mergeAuth\"](accountToSave, userCredentials);\n            _context.next = 16;\n            break;\n\n          case 12:\n            _context.next = 14;\n            return Object(_connections_accounts__WEBPACK_IMPORTED_MODULE_8__[\"fetchReusableAccount\"])(client, konnector);\n\n          case 14:\n            recycableAccount = _context.sent;\n\n            if (recycableAccount) {\n              accountToSave = _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"mergeAuth\"](recycableAccount, userCredentials);\n            } else {\n              accountToSave = _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"build\"](konnector, userCredentials);\n            }\n\n          case 16:\n            if (!onAccountCreation) {\n              _context.next = 21;\n              break;\n            }\n\n            _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"Using \".concat(konnectorPolicy.name, \" konnector policy custom account creation\"));\n            _context.next = 20;\n            return onAccountCreation({\n              client: client,\n              flow: flow,\n              account: accountToSave,\n              konnector: konnector\n            });\n\n          case 20:\n            accountToSave = _context.sent;\n\n          case 21:\n            if (cipher && saveInVault) {\n              accountToSave = _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"setVaultCipherRelationship\"](accountToSave, cipher.id);\n            } else {\n              _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].warn(\"No cipher passed when creating/updating account, account will not be linked to cipher\");\n            }\n\n            _context.next = 24;\n            return Object(_connections_accounts__WEBPACK_IMPORTED_MODULE_8__[\"saveAccount\"])(client, konnector, accountToSave);\n\n          case 24:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 25:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function createOrUpdateAccount(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n/**\n * Event hub to launch and follow a konnector job.\n *\n * - Creates the job for a trigger\n * - Listens to changes on\n *   - the created job\n *   - the account linked to the trigger\n *\n * Transforms low-level events happening on the documents to higher-level events\n * closer to business logic.\n *\n * This should be the go to source of truth for the state of a Konnector Job.\n */\n\nvar ConnectionFlow = /*#__PURE__*/function () {\n  function ConnectionFlow(client, trigger, konnector) {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, ConnectionFlow);\n\n    this.client = client;\n    this.trigger = trigger;\n    this.konnector = konnector;\n    this.unsubscribeAllRealtime = null; // Bind methods used as callbacks\n\n    this.getTwoFACodeProvider = this.getTwoFACodeProvider.bind(this);\n    this.getKonnectorSlug = this.getKonnectorSlug.bind(this);\n    this.handleAccountUpdated = this.handleAccountUpdated.bind(this);\n    this.handleJobUpdated = this.handleJobUpdated.bind(this);\n    this.handleAccountTwoFA = this.handleAccountTwoFA.bind(this);\n    this.launch = this.launch.bind(this);\n    this.sendTwoFACode = this.sendTwoFACode.bind(this);\n    this.unwatch = this.unwatch.bind(this);\n    this.state = {\n      status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"IDLE\"]\n    }; // Stores data necessary for custom connection flow, for example\n    // a budget-insight temporary token\n\n    this.data = {};\n    this.twoFAWaiters = this.twoFAWaiters || [];\n    this.realtime = new cozy_realtime__WEBPACK_IMPORTED_MODULE_6___default.a({\n      client: client\n    });\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(ConnectionFlow, [{\n    key: \"getTwoFACodeProvider\",\n    value: function getTwoFACodeProvider() {\n      return _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"getTwoFACodeProvider\"](this.account);\n    }\n  }, {\n    key: \"getKonnectorSlug\",\n    value: function getKonnectorSlug() {\n      return this.trigger.message.konnector;\n    }\n  }, {\n    key: \"handleAccountTwoFA\",\n    value: function handleAccountTwoFA(prevAccount) {\n      var account = this.account;\n      var prevState = prevAccount && prevAccount.state;\n      var state = account.state;\n      return this.handleTwoFAStateChange(state, prevState);\n    }\n  }, {\n    key: \"handleTwoFAStateChange\",\n    value: function handleTwoFAStateChange(state) {\n      var prevState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n      if (prevState === state) {\n        return;\n      }\n\n      if (_helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"isTwoFANeeded\"](state)) {\n        this.setState({\n          status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"TWO_FA_REQUEST\"]\n        });\n        this.emit(_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"TWO_FA_REQUEST_EVENT\"]);\n      } else if (_helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"isTwoFARetry\"](state)) {\n        this.setState({\n          status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"TWO_FA_MISMATCH\"]\n        });\n        this.emit(_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"TWO_FA_MISMATCH_EVENT\"]);\n      }\n    }\n  }, {\n    key: \"triggerEvent\",\n    value: function triggerEvent(eventName) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"ConnectionFlow: triggerEvent \".concat(eventName), args);\n\n      if (isStepEvent(eventName)) {\n        this.setState(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default()({}, eventName, true));\n      }\n\n      if (eventToStatus[eventName]) {\n        _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"ConnectionFlow: Setting status \".concat(eventToStatus[eventName]));\n        this.setState({\n          status: eventToStatus[eventName]\n        });\n      }\n\n      if (eventName === _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"ERROR_EVENT\"]) {\n        this.refetchTrigger();\n      }\n\n      this.emit.apply(this, [eventName].concat(args));\n    }\n  }, {\n    key: \"getAccount\",\n    value: function getAccount() {\n      return this.account;\n    }\n  }, {\n    key: \"saveTwoFARequest\",\n    value: function () {\n      var _saveTwoFARequest = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee2(twoFARequestOptions) {\n        var account;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"Saving 2FA request\", twoFARequestOptions);\n                this.setState({\n                  status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"WAITING_TWOFA\"]\n                });\n                _context2.prev = 2;\n                account = _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"updateTwoFAState\"](this.account, twoFARequestOptions);\n                _context2.next = 6;\n                return this.saveAccount(account);\n\n              case 6:\n                this.triggerEvent(_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"TWO_FA_REQUEST_EVENT\"], twoFARequestOptions);\n                _context2.next = 13;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](2);\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].error(_context2.t0);\n                this.setState({\n                  status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"ERRORED\"],\n                  error: _context2.t0\n                });\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[2, 9]]);\n      }));\n\n      function saveTwoFARequest(_x2) {\n        return _saveTwoFARequest.apply(this, arguments);\n      }\n\n      return saveTwoFARequest;\n    }()\n    /**\n     * Waits until two fa code has been sent\n     *\n     * - Monitors the account (for the case where the 2FA code is filled by the konnector job)\n     * - Subscribes a \"manual\" waiter for when the 2FA is done completely in-browser (budget-insight\n     *   for example)\n     *\n     */\n\n  }, {\n    key: \"waitForTwoFA\",\n    value: function waitForTwoFA() {\n      var _this = this;\n\n      _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"ConnectionFlow: Waiting for two FA\");\n\n      if (this.jobWatcher) {\n        this.jobWatcher.disableSuccessTimer();\n      }\n\n      return new Promise(function (rawResolve) {\n        var accountId = _this.account._id;\n        Object(_assert__WEBPACK_IMPORTED_MODULE_17__[\"default\"])(accountId, \"Cannot wait for two fa on account without id\");\n\n        var resolve = function resolve() {\n          _this.realtime.unsubscribe(\"updated\", _connections_accounts__WEBPACK_IMPORTED_MODULE_8__[\"ACCOUNTS_DOCTYPE\"], accountId, handleAccountUpdate);\n\n          rawResolve();\n        };\n\n        var handleAccountUpdate = function handleAccountUpdate(account) {\n          if (account && account.twoFACode) {\n            resolve();\n          }\n        };\n\n        var updateFromCustomPolicy = function updateFromCustomPolicy() {\n          resolve();\n        };\n\n        _this.twoFAWaiters.push(updateFromCustomPolicy);\n\n        _this.realtime.subscribe(\"updated\", _connections_accounts__WEBPACK_IMPORTED_MODULE_8__[\"ACCOUNTS_DOCTYPE\"], accountId, handleAccountUpdate);\n      });\n    }\n    /**\n     * Saves and updates internal account\n     */\n\n  }, {\n    key: \"saveAccount\",\n    value: function () {\n      var _saveAccount2 = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee3(updatedAccount) {\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"ConnectionFlow: Saving account\");\n                _context3.next = 3;\n                return Object(_connections_accounts__WEBPACK_IMPORTED_MODULE_8__[\"saveAccount\"])(this.client, this.konnector, updatedAccount);\n\n              case 3:\n                this.account = _context3.sent;\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"ConnectionFlow: Saved account\");\n                return _context3.abrupt(\"return\", this.account);\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function saveAccount(_x3) {\n        return _saveAccount2.apply(this, arguments);\n      }\n\n      return saveAccount;\n    }()\n  }, {\n    key: \"flushTwoFAWaiters\",\n    value: function flushTwoFAWaiters() {\n      _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"ConnectionFlow: Flushing \".concat(this.twoFAWaiters.length, \" two fa waiters\"));\n\n      var _iterator = _createForOfIteratorHelper(this.twoFAWaiters),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var callback = _step.value;\n          callback();\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      this.twoFAWaiters = [];\n    }\n  }, {\n    key: \"sendAdditionalInformation\",\n    value: function () {\n      var _sendAdditionalInformation = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee4(fields) {\n        var konnectorPolicy;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.setState({\n                  status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"RUNNING_TWOFA\"]\n                });\n                _context4.prev = 1;\n                konnectorPolicy = this.getKonnectorPolicy();\n                _context4.next = 5;\n                return konnectorPolicy.sendAdditionalInformation(this, fields);\n\n              case 5:\n                this.flushTwoFAWaiters();\n                _context4.next = 12;\n                break;\n\n              case 8:\n                _context4.prev = 8;\n                _context4.t0 = _context4[\"catch\"](1);\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].error(_context4.t0);\n                this.setState({\n                  status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"ERRORED\"],\n                  error: _context4.t0\n                });\n\n              case 12:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[1, 8]]);\n      }));\n\n      function sendAdditionalInformation(_x4) {\n        return _sendAdditionalInformation.apply(this, arguments);\n      }\n\n      return sendAdditionalInformation;\n    }()\n    /**\n     * \"Sends\" 2FA Code\n     */\n\n  }, {\n    key: \"sendTwoFACode\",\n    value: function () {\n      var _sendTwoFACode = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee5(code) {\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                this.setState({\n                  status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"RUNNING_TWOFA\"]\n                });\n                _context5.prev = 1;\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"ConnectionFlow: Sending two fa code \".concat(code));\n                _context5.next = 5;\n                return this.saveAccount(_helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"updateTwoFaCode\"](this.account, code));\n\n              case 5:\n                _context5.next = 11;\n                break;\n\n              case 7:\n                _context5.prev = 7;\n                _context5.t0 = _context5[\"catch\"](1);\n                // eslint-disable-next-line no-console\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].error(_context5.t0);\n                this.setState({\n                  status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"ERRORED\"],\n                  error: _context5.t0\n                });\n\n              case 11:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[1, 7]]);\n      }));\n\n      function sendTwoFACode(_x5) {\n        return _sendTwoFACode.apply(this, arguments);\n      }\n\n      return sendTwoFACode;\n    }()\n  }, {\n    key: \"handleLoginSuccess\",\n    value: function handleLoginSuccess() {\n      this.jobWatcher.handleSuccess();\n    }\n  }, {\n    key: \"handleLoginSuccessHandled\",\n    value: function handleLoginSuccessHandled() {\n      this.jobWatcher.disableSuccessTimer();\n    }\n    /**\n     * - Creates io.cozy.accounts\n     * - Links cipher to account\n     * - Saves account\n     * - Ensures trigger is existing for account\n     * - Finds cipher via identifier / password\n     * - Ensures a cipher is created if vault is unlocked\n     * - Launches konnector job\n     */\n\n  }, {\n    key: \"handleFormSubmit\",\n    value: function () {\n      var _handleFormSubmit = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee6(options) {\n        var konnector, cipherId, vaultClient, userCredentials, t, account, trigger, client, konnectorPolicy, cipher;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                konnector = options.konnector, cipherId = options.cipherId, vaultClient = options.vaultClient, userCredentials = options.userCredentials, t = options.t;\n                _context6.prev = 1;\n                account = options.account, trigger = options.trigger;\n                client = this.client;\n                this.setState({\n                  status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"CREATING_ACCOUNT\"]\n                });\n                this.trigger = trigger;\n                this.account = account;\n                this.konnector = konnector;\n                this.t = t;\n                Object(_assert__WEBPACK_IMPORTED_MODULE_17__[\"default\"])(client, \"No client\");\n                konnectorPolicy = Object(_konnector_policies__WEBPACK_IMPORTED_MODULE_15__[\"findKonnectorPolicy\"])(konnector);\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].log(\"ConnectionFlow: Handling submit, with konnector policy \".concat(konnectorPolicy.name));\n\n                if (!konnectorPolicy.saveInVault) {\n                  _context6.next = 18;\n                  break;\n                }\n\n                _context6.next = 15;\n                return Object(_models_cipherUtils__WEBPACK_IMPORTED_MODULE_16__[\"createOrUpdateCipher\"])(vaultClient, cipherId, {\n                  account: account,\n                  konnector: konnector,\n                  userCredentials: userCredentials\n                });\n\n              case 15:\n                cipher = _context6.sent;\n                _context6.next = 19;\n                break;\n\n              case 18:\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"ConnectionFlow: Bypassing cipher creation because of konnector account policy\");\n\n              case 19:\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"ConnectionFlow: Creating/updating account...\", account);\n                _context6.next = 22;\n                return createOrUpdateAccount({\n                  account: account,\n                  cipher: cipher,\n                  client: client,\n                  flow: this,\n                  konnector: konnector,\n                  konnectorPolicy: konnectorPolicy,\n                  userCredentials: userCredentials\n                });\n\n              case 22:\n                account = _context6.sent;\n                this.account = account;\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"ConnectionFlow: Saved account \".concat(account._id));\n                _context6.next = 27;\n                return this.ensureTriggerAndLaunch(client, {\n                  trigger: trigger,\n                  account: account,\n                  konnector: konnector,\n                  t: t\n                });\n\n              case 27:\n                this.setState({\n                  accountError: null\n                });\n                _context6.next = 37;\n                break;\n\n              case 30:\n                _context6.prev = 30;\n                _context6.t0 = _context6[\"catch\"](1);\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].error(_context6.t0);\n                this.setState({\n                  accountError: _context6.t0\n                });\n                this.triggerEvent(_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"ERROR_EVENT\"], _context6.t0);\n                _sentry__WEBPACK_IMPORTED_MODULE_20__[\"default\"].withScope(function (scope) {\n                  scope.setTag(\"konnector\", konnector.slug); // Capture the original exception instead of the user one\n\n                  _sentry__WEBPACK_IMPORTED_MODULE_20__[\"default\"].captureException(_context6.t0.original || _context6.t0);\n                });\n                throw _context6.t0;\n\n              case 37:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[1, 30]]);\n      }));\n\n      function handleFormSubmit(_x6) {\n        return _handleFormSubmit.apply(this, arguments);\n      }\n\n      return handleFormSubmit;\n    }()\n  }, {\n    key: \"handleAccountUpdated\",\n    value: function handleAccountUpdated(account) {\n      var prevAccount = this.account; // _type is not present in objects from realtime but we have to keep\n      // it to be compatible with cozy-client's methods\n      //\n\n      this.account = _objectSpread({\n        _type: prevAccount._type\n      }, account);\n      var state = this.account.state;\n\n      if (_helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"isTwoFANeeded\"](state) || _helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"isTwoFARetry\"](state)) {\n        this.handleAccountTwoFA(prevAccount);\n      } else if (_helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"isLoginSuccessHandled\"](state)) {\n        this.handleLoginSuccessHandled();\n      } else if (_helpers_accounts__WEBPACK_IMPORTED_MODULE_18__[\"isLoginSuccess\"](state)) {\n        this.handleLoginSuccess();\n      }\n    }\n  }, {\n    key: \"handleJobUpdated\",\n    value: function () {\n      var _handleJobUpdated = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee7() {\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"ConnectionFlow: Handling update from job\");\n                _context7.next = 3;\n                return this.refetchTrigger();\n\n              case 3:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function handleJobUpdated() {\n        return _handleJobUpdated.apply(this, arguments);\n      }\n\n      return handleJobUpdated;\n    }()\n  }, {\n    key: \"refetchTrigger\",\n    value: function () {\n      var _refetchTrigger = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee8() {\n        var trigger;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                if (this.trigger) {\n                  _context8.next = 2;\n                  break;\n                }\n\n                return _context8.abrupt(\"return\", null);\n\n              case 2:\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"ConnectionFlow: Refetching trigger  \".concat(this.trigger._id));\n                _context8.next = 5;\n                return Object(_connections_triggers__WEBPACK_IMPORTED_MODULE_11__[\"fetchTrigger\"])(this.client, this.trigger._id);\n\n              case 5:\n                trigger = _context8.sent;\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"Refetched trigger\", trigger);\n                this.trigger = trigger;\n                this.emit(_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"UPDATE_EVENT\"]);\n\n              case 9:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function refetchTrigger() {\n        return _refetchTrigger.apply(this, arguments);\n      }\n\n      return refetchTrigger;\n    }()\n  }, {\n    key: \"ensureTriggerAndLaunch\",\n    value: function () {\n      var _ensureTriggerAndLaunch = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee9(client, _ref3) {\n        var trigger, account, konnector, t, ensuredTrigger;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                trigger = _ref3.trigger, account = _ref3.account, konnector = _ref3.konnector, t = _ref3.t;\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].debug(\"ConnectionFlow: Ensuring trigger...\");\n                this.t = t;\n                _context9.next = 5;\n                return Object(_connections_triggers__WEBPACK_IMPORTED_MODULE_11__[\"ensureTrigger\"])(client, {\n                  trigger: trigger,\n                  account: account,\n                  konnector: konnector,\n                  t: t\n                });\n\n              case 5:\n                ensuredTrigger = _context9.sent;\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"Trigger is \".concat(ensuredTrigger._id));\n                this.trigger = ensuredTrigger;\n                this.emit(_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"UPDATE_EVENT\"]);\n                _context9.next = 11;\n                return this.launch();\n\n              case 11:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function ensureTriggerAndLaunch(_x7, _x8) {\n        return _ensureTriggerAndLaunch.apply(this, arguments);\n      }\n\n      return ensureTriggerAndLaunch;\n    }()\n    /**\n     * Launches the job and sets everything up to follow execution.\n     */\n\n  }, {\n    key: \"launch\",\n    value: function () {\n      var _launch = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee10() {\n        var _this2 = this;\n\n        var _ref4,\n            _ref4$autoSuccessTime,\n            autoSuccessTimer,\n            clientSideSlugs,\n            _iterator2,\n            _step2,\n            _loop,\n            _args10 = arguments;\n\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _ref4 = _args10.length > 0 && _args10[0] !== undefined ? _args10[0] : {}, _ref4$autoSuccessTime = _ref4.autoSuccessTimer, autoSuccessTimer = _ref4$autoSuccessTime === void 0 ? true : _ref4$autoSuccessTime;\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"ConnectionFlow: Launching job...\");\n                this.setState({\n                  status: _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"PENDING\"]\n                });\n                _context10.next = 5;\n                return Object(_connections_triggers__WEBPACK_IMPORTED_MODULE_11__[\"prepareTriggerAccount\"])(this.client, this.trigger);\n\n              case 5:\n                this.account = _context10.sent;\n                this.realtime.subscribe(\"updated\", _connections_accounts__WEBPACK_IMPORTED_MODULE_8__[\"ACCOUNTS_DOCTYPE\"], this.account._id, this.handleAccountUpdated);\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"ConnectionFlow: Subscribed to \".concat(_connections_accounts__WEBPACK_IMPORTED_MODULE_8__[\"ACCOUNTS_DOCTYPE\"], \":\").concat(this.account._id));\n                _context10.next = 10;\n                return Object(_connections_triggers__WEBPACK_IMPORTED_MODULE_11__[\"launchTrigger\"])(this.client, this.trigger);\n\n              case 10:\n                this.job = _context10.sent;\n                clientSideSlugs = lodash_get__WEBPACK_IMPORTED_MODULE_10___default()(window, \"cozy.clientSideSlugs\", []);\n\n                if (clientSideSlugs.includes(this.konnector.slug)) {\n                  _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"This connector can be run by the launcher\", this.konnector.slug);\n\n                  if (lodash_get__WEBPACK_IMPORTED_MODULE_10___default()(window, \"cozy.ClientConnectorLauncher\") === \"react-native\") {\n                    _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].warn(\"Found client connector react-native launcher\");\n                    window.ReactNativeWebView.postMessage(JSON.stringify({\n                      message: \"startLauncher\",\n                      value: {\n                        connector: this.konnector,\n                        account: this.account,\n                        trigger: this.trigger,\n                        job: this.job\n                      }\n                    }));\n                  } else {\n                    _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"Found no client connector launcher\");\n                  }\n                }\n\n                this.realtime.subscribe(\"updated\", JOBS_DOCTYPE, this.job._id, this.handleJobUpdated.bind(this));\n                this.jobWatcher = Object(_models_konnector_KonnectorJobWatcher__WEBPACK_IMPORTED_MODULE_13__[\"watchKonnectorJob\"])(this.client, this.job, {\n                  autoSuccessTimer: autoSuccessTimer\n                });\n                _logger__WEBPACK_IMPORTED_MODULE_14__[\"default\"].info(\"ConnectionFlow: Subscribed to \".concat(JOBS_DOCTYPE, \":\").concat(this.job._id));\n                _iterator2 = _createForOfIteratorHelper(_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"JOB_EVENTS\"]);\n\n                try {\n                  _loop = function _loop() {\n                    var ev = _step2.value;\n\n                    _this2.jobWatcher.on(ev, function () {\n                      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                        args[_key2] = arguments[_key2];\n                      }\n\n                      return _this2.triggerEvent.apply(_this2, [ev].concat(args));\n                    });\n                  };\n\n                  for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                    _loop();\n                  }\n                } catch (err) {\n                  _iterator2.e(err);\n                } finally {\n                  _iterator2.f();\n                }\n\n                this.unsubscribeAllRealtime = function () {\n                  _this2.jobWatcher.unsubscribeAll();\n\n                  _this2.realtime.unsubscribeAll();\n                };\n\n              case 19:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function launch() {\n        return _launch.apply(this, arguments);\n      }\n\n      return launch;\n    }()\n  }, {\n    key: \"unwatch\",\n    value: function unwatch() {\n      if (typeof this.unsubscribeAllRealtime === \"function\") {\n        this.unsubscribeAllRealtime();\n      }\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.trigger = null;\n      this.job = null;\n      this.emit(_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"UPDATE_EVENT\"]);\n    }\n  }, {\n    key: \"getMockError\",\n    value: function getMockError() {\n      return cozy_flags__WEBPACK_IMPORTED_MODULE_7___default()(\"harvest.force-last-error\") ? new _helpers_konnectors__WEBPACK_IMPORTED_MODULE_12__[\"KonnectorJobError\"](cozy_flags__WEBPACK_IMPORTED_MODULE_7___default()(\"harvest.force-last-error\")) : null;\n    }\n  }, {\n    key: \"getDerivedState\",\n    value: function getDerivedState() {\n      var trigger = this.trigger;\n      var _this$state = this.state,\n          status = _this$state.status,\n          accountError = _this$state.accountError;\n      var triggerError = _helpers_triggers__WEBPACK_IMPORTED_MODULE_19__[\"getKonnectorJobError\"](trigger);\n      return {\n        running: ![_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"ERRORED\"], _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"IDLE\"], _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"SUCCESS\"]].includes(status),\n        twoFARunning: status === _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"RUNNING_TWOFA\"],\n        twoFARetry: status == _flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"TWO_FA_MISMATCH\"],\n        triggerError: triggerError,\n        trigger: trigger,\n        accountError: accountError,\n        error: this.getMockError() || accountError || triggerError,\n        konnectorRunning: _helpers_triggers__WEBPACK_IMPORTED_MODULE_19__[\"isKonnectorRunning\"](trigger)\n      };\n    }\n  }, {\n    key: \"getState\",\n    value: function getState() {\n      return _objectSpread(_objectSpread({}, this.state), this.getDerivedState());\n    }\n  }, {\n    key: \"setState\",\n    value: function setState(update) {\n      this.state = _objectSpread(_objectSpread({}, this.state), update);\n      this.emit(_flowEvents__WEBPACK_IMPORTED_MODULE_21__[\"UPDATE_EVENT\"]);\n    }\n  }, {\n    key: \"setData\",\n    value: function setData(update) {\n      this.data = _objectSpread(_objectSpread({}, this.data), update);\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      return this.data;\n    }\n  }, {\n    key: \"getKonnectorPolicy\",\n    value: function getKonnectorPolicy() {\n      return Object(_konnector_policies__WEBPACK_IMPORTED_MODULE_15__[\"findKonnectorPolicy\"])(this.konnector);\n    }\n  }, {\n    key: \"getAdditionalInformationNeeded\",\n    value: function getAdditionalInformationNeeded() {\n      var konnectorPolicy = this.getKonnectorPolicy();\n\n      if (!konnectorPolicy) {\n        throw new Error(\"A konnector policy is needed to be able to detect additional information\");\n      } else if (!konnectorPolicy.getAdditionalInformationNeeded) {\n        throw new Error(\"No getAdditionalInformationNeeded in konnector policy\");\n      } else {\n        var fields = konnectorPolicy.getAdditionalInformationNeeded(this);\n        return fields;\n      }\n    }\n  }]);\n\n  return ConnectionFlow;\n}();\nmicroee__WEBPACK_IMPORTED_MODULE_5___default.a.mixin(ConnectionFlow);\n/* harmony default export */ __webpack_exports__[\"default\"] = (ConnectionFlow);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvY296eS1oYXJ2ZXN0LWxpYi9kaXN0L21vZGVscy9Db25uZWN0aW9uRmxvdy5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9jb3p5LWhhcnZlc3QtbGliL2Rpc3QvbW9kZWxzL0Nvbm5lY3Rpb25GbG93LmpzP2ZjNzEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiO1xuaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzc1wiO1xuaW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSBcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCI7XG5pbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiO1xuaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eVwiO1xuXG52YXIgX2V2ZW50VG9TdGF0dXM7XG5cbmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9XG5cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfVxuXG5mdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihvLCBhbGxvd0FycmF5TGlrZSkgeyB2YXIgaXQ7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcInVuZGVmaW5lZFwiIHx8IG9bU3ltYm9sLml0ZXJhdG9yXSA9PSBudWxsKSB7IGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHsgaWYgKGl0KSBvID0gaXQ7IHZhciBpID0gMDsgdmFyIEYgPSBmdW5jdGlvbiBGKCkge307IHJldHVybiB7IHM6IEYsIG46IGZ1bmN0aW9uIG4oKSB7IGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4geyBkb25lOiB0cnVlIH07IHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogb1tpKytdIH07IH0sIGU6IGZ1bmN0aW9uIGUoX2UpIHsgdGhyb3cgX2U7IH0sIGY6IEYgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7IH0gdmFyIG5vcm1hbENvbXBsZXRpb24gPSB0cnVlLCBkaWRFcnIgPSBmYWxzZSwgZXJyOyByZXR1cm4geyBzOiBmdW5jdGlvbiBzKCkgeyBpdCA9IG9bU3ltYm9sLml0ZXJhdG9yXSgpOyB9LCBuOiBmdW5jdGlvbiBuKCkgeyB2YXIgc3RlcCA9IGl0Lm5leHQoKTsgbm9ybWFsQ29tcGxldGlvbiA9IHN0ZXAuZG9uZTsgcmV0dXJuIHN0ZXA7IH0sIGU6IGZ1bmN0aW9uIGUoX2UyKSB7IGRpZEVyciA9IHRydWU7IGVyciA9IF9lMjsgfSwgZjogZnVuY3Rpb24gZigpIHsgdHJ5IHsgaWYgKCFub3JtYWxDb21wbGV0aW9uICYmIGl0LnJldHVybiAhPSBudWxsKSBpdC5yZXR1cm4oKTsgfSBmaW5hbGx5IHsgaWYgKGRpZEVycikgdGhyb3cgZXJyOyB9IH0gfTsgfVxuXG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH1cblxuZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9XG5cbmltcG9ydCBNaWNyb0VFIGZyb20gXCJtaWNyb2VlXCI7XG5pbXBvcnQgUmVhbHRpbWUgZnJvbSBcImNvenktcmVhbHRpbWVcIjtcbmltcG9ydCBmbGFnIGZyb20gXCJjb3p5LWZsYWdzXCI7XG5pbXBvcnQgeyBmZXRjaFJldXNhYmxlQWNjb3VudCwgc2F2ZUFjY291bnQgYXMgX3NhdmVBY2NvdW50LCBBQ0NPVU5UU19ET0NUWVBFIH0gZnJvbSBcIi4uL2Nvbm5lY3Rpb25zL2FjY291bnRzXCI7XG5pbXBvcnQgY2xvbmUgZnJvbSBcImxvZGFzaC9jbG9uZVwiO1xuaW1wb3J0IGdldCBmcm9tIFwibG9kYXNoL2dldFwiO1xuaW1wb3J0IHsgbGF1bmNoVHJpZ2dlciwgcHJlcGFyZVRyaWdnZXJBY2NvdW50LCBmZXRjaFRyaWdnZXIsIGVuc3VyZVRyaWdnZXIgfSBmcm9tIFwiLi4vY29ubmVjdGlvbnMvdHJpZ2dlcnNcIjtcbmltcG9ydCB7IEtvbm5lY3RvckpvYkVycm9yIH0gZnJvbSBcIi4uL2hlbHBlcnMva29ubmVjdG9yc1wiO1xuaW1wb3J0IHsgd2F0Y2hLb25uZWN0b3JKb2IgfSBmcm9tIFwiLi4vbW9kZWxzL2tvbm5lY3Rvci9Lb25uZWN0b3JKb2JXYXRjaGVyXCI7XG5pbXBvcnQgbG9nZ2VyIGZyb20gXCIuLi9sb2dnZXJcIjtcbmltcG9ydCB7IGZpbmRLb25uZWN0b3JQb2xpY3kgfSBmcm9tIFwiLi4va29ubmVjdG9yLXBvbGljaWVzXCI7XG5pbXBvcnQgeyBjcmVhdGVPclVwZGF0ZUNpcGhlciB9IGZyb20gXCIuLi9tb2RlbHMvY2lwaGVyVXRpbHNcIjtcbmltcG9ydCBhc3NlcnQgZnJvbSBcIi4uL2Fzc2VydFwiO1xuaW1wb3J0ICogYXMgYWNjb3VudHMgZnJvbSBcIi4uL2hlbHBlcnMvYWNjb3VudHNcIjtcbmltcG9ydCAqIGFzIHRyaWdnZXJzTW9kZWwgZnJvbSBcIi4uL2hlbHBlcnMvdHJpZ2dlcnNcIjtcbmltcG9ydCBzZW50cnlIdWIgZnJvbSBcIi4uL3NlbnRyeVwiO1xuaW1wb3J0IHsgRVJST1JFRCwgRVJST1JfRVZFTlQsIExPR0lOX1NVQ0NFU1MsIExPR0lOX1NVQ0NFU1NfRVZFTlQsIFNVQ0NFU1MsIFNVQ0NFU1NfRVZFTlQsIElETEUsIFVQREFURV9FVkVOVCwgUlVOTklOR19UV09GQSwgVFdPX0ZBX1JFUVVFU1QsIFRXT19GQV9SRVFVRVNUX0VWRU5ULCBUV09fRkFfTUlTTUFUQ0gsIFRXT19GQV9NSVNNQVRDSF9FVkVOVCwgV0FJVElOR19UV09GQSwgQ1JFQVRJTkdfQUNDT1VOVCwgUEVORElORywgSk9CX0VWRU5UUyB9IGZyb20gXCIuL2Zsb3dFdmVudHNcIjtcbnZhciBKT0JTX0RPQ1RZUEUgPSBcImlvLmNvenkuam9ic1wiO1xudmFyIGV2ZW50VG9TdGF0dXMgPSAoX2V2ZW50VG9TdGF0dXMgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9ldmVudFRvU3RhdHVzLCBFUlJPUl9FVkVOVCwgRVJST1JFRCksIF9kZWZpbmVQcm9wZXJ0eShfZXZlbnRUb1N0YXR1cywgTE9HSU5fU1VDQ0VTU19FVkVOVCwgTE9HSU5fU1VDQ0VTUyksIF9kZWZpbmVQcm9wZXJ0eShfZXZlbnRUb1N0YXR1cywgU1VDQ0VTU19FVkVOVCwgU1VDQ0VTUyksIF9ldmVudFRvU3RhdHVzKTtcbnZhciBzdGVwRXZlbnRzID0gW0xPR0lOX1NVQ0NFU1NfRVZFTlRdO1xuXG52YXIgaXNTdGVwRXZlbnQgPSBmdW5jdGlvbiBpc1N0ZXBFdmVudChldmVudE5hbWUpIHtcbiAgcmV0dXJuIHN0ZXBFdmVudHMuaW5jbHVkZXMoZXZlbnROYW1lKTtcbn07XG4vKipcbiAqIENyZWF0ZXMgb3IgdXBkYXRlcyBhbiBpby5jb3p5LmFjY291bnRzIGZyb20gdXNlciBzdWJtaXR0ZWQgZGF0YVxuICogVXNlZCBhcyBhIGZvcm0gc3VibWl0IGhhbmRsZXJcbiAqXG4gKiBAcGFyYW0gIHtpby5jb3p5LmFjY291bnR9IG9wdGlvbnMuYWNjb3VudCAtIEV4aXN0aW5nIGlvLmNvenkuYWNjb3VudCBvciBvYmplY3RcbiAqIEBwYXJhbSAge0NpcGhlcn0gb3B0aW9ucy5jaXBoZXIgLSBWYXVsdCBjaXBoZXIgaWYgdmF1bHQgaGFzIGJlZW4gdW5sb2NrZWRcbiAqIEBwYXJhbSAge0NvenlDbGllbnR9IG9wdGlvbnMuY2xpZW50IC0gQSBjb3p5IGNsaWVudFxuICogQHBhcmFtICB7aW8uY296eS5rb25uZWN0b3J9IG9wdGlvbnMua29ubmVjdG9yIC0gS29ubmVjdG9yIHRvIHdoaWNoIHRoZSBhY2NvdW50IGlzIGxpbmtlZFxuICogQHBhcmFtICB7S29ubmVjdG9yUG9saWN5fSBvcHRpb25zLmtvbm5lY3RvclBvbGljeSAtIENvbnRyb2xzIGlmIGF1dGggaXMgc2F2ZWQgaW4gaW8uY296eS5hY2NvdW50c1xuICogYW5kIGlmIGF1dGggaXMgc2F2ZWQgaW50byB0aGUgdmF1bHRcbiAqIEBwYXJhbSAge2Z1bmN0aW9ufSBvcHRpb25zLnNhdmVBY2NvdW50XG4gKiBAcGFyYW0gIHtvYmplY3R9IG9wdGlvbnMudXNlckNyZWRlbnRpYWxzXG4gKi9cblxuXG5leHBvcnQgdmFyIGNyZWF0ZU9yVXBkYXRlQWNjb3VudCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBfcmVmMiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoX3JlZikge1xuICAgIHZhciBhY2NvdW50LCBjaXBoZXIsIGNsaWVudCwgZmxvdywga29ubmVjdG9yLCBrb25uZWN0b3JQb2xpY3ksIHVzZXJDcmVkZW50aWFscywgaXNVcGRhdGUsIG9uQWNjb3VudENyZWF0aW9uLCBzYXZlSW5WYXVsdCwgYWNjb3VudFRvU2F2ZSwgcmVjeWNhYmxlQWNjb3VudDtcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgYWNjb3VudCA9IF9yZWYuYWNjb3VudCwgY2lwaGVyID0gX3JlZi5jaXBoZXIsIGNsaWVudCA9IF9yZWYuY2xpZW50LCBmbG93ID0gX3JlZi5mbG93LCBrb25uZWN0b3IgPSBfcmVmLmtvbm5lY3Rvciwga29ubmVjdG9yUG9saWN5ID0gX3JlZi5rb25uZWN0b3JQb2xpY3ksIHVzZXJDcmVkZW50aWFscyA9IF9yZWYudXNlckNyZWRlbnRpYWxzO1xuICAgICAgICAgICAgYXNzZXJ0KGZsb3csIFwiTm8gZmxvd1wiKTtcbiAgICAgICAgICAgIGlzVXBkYXRlID0gISFhY2NvdW50O1xuXG4gICAgICAgICAgICBpZiAoaXNVcGRhdGUpIHtcbiAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKFwiVXBkYXRpbmcgdGhlIGFjY291bnQuLi5cIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoXCJDcmVhdGluZyB0aGUgYWNjb3VudC4uLlwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb25BY2NvdW50Q3JlYXRpb24gPSBrb25uZWN0b3JQb2xpY3kub25BY2NvdW50Q3JlYXRpb24sIHNhdmVJblZhdWx0ID0ga29ubmVjdG9yUG9saWN5LnNhdmVJblZhdWx0O1xuICAgICAgICAgICAgYWNjb3VudFRvU2F2ZSA9IGNsb25lKGFjY291bnQpIHx8IHt9O1xuICAgICAgICAgICAgYWNjb3VudFRvU2F2ZSA9IGFjY291bnRzLnJlc2V0U3RhdGUoYWNjb3VudFRvU2F2ZSk7XG4gICAgICAgICAgICBhY2NvdW50VG9TYXZlID0gYWNjb3VudHMuc2V0U2Vzc2lvblJlc2V0SWZOZWNlc3NhcnkoYWNjb3VudFRvU2F2ZSwgdXNlckNyZWRlbnRpYWxzKTtcblxuICAgICAgICAgICAgaWYgKCFpc1VwZGF0ZSkge1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhY2NvdW50VG9TYXZlID0gYWNjb3VudHMubWVyZ2VBdXRoKGFjY291bnRUb1NhdmUsIHVzZXJDcmVkZW50aWFscyk7XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTY7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7XG4gICAgICAgICAgICByZXR1cm4gZmV0Y2hSZXVzYWJsZUFjY291bnQoY2xpZW50LCBrb25uZWN0b3IpO1xuXG4gICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgIHJlY3ljYWJsZUFjY291bnQgPSBfY29udGV4dC5zZW50O1xuXG4gICAgICAgICAgICBpZiAocmVjeWNhYmxlQWNjb3VudCkge1xuICAgICAgICAgICAgICBhY2NvdW50VG9TYXZlID0gYWNjb3VudHMubWVyZ2VBdXRoKHJlY3ljYWJsZUFjY291bnQsIHVzZXJDcmVkZW50aWFscyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhY2NvdW50VG9TYXZlID0gYWNjb3VudHMuYnVpbGQoa29ubmVjdG9yLCB1c2VyQ3JlZGVudGlhbHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgY2FzZSAxNjpcbiAgICAgICAgICAgIGlmICghb25BY2NvdW50Q3JlYXRpb24pIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKFwiVXNpbmcgXCIuY29uY2F0KGtvbm5lY3RvclBvbGljeS5uYW1lLCBcIiBrb25uZWN0b3IgcG9saWN5IGN1c3RvbSBhY2NvdW50IGNyZWF0aW9uXCIpKTtcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMDtcbiAgICAgICAgICAgIHJldHVybiBvbkFjY291bnRDcmVhdGlvbih7XG4gICAgICAgICAgICAgIGNsaWVudDogY2xpZW50LFxuICAgICAgICAgICAgICBmbG93OiBmbG93LFxuICAgICAgICAgICAgICBhY2NvdW50OiBhY2NvdW50VG9TYXZlLFxuICAgICAgICAgICAgICBrb25uZWN0b3I6IGtvbm5lY3RvclxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgYWNjb3VudFRvU2F2ZSA9IF9jb250ZXh0LnNlbnQ7XG5cbiAgICAgICAgICBjYXNlIDIxOlxuICAgICAgICAgICAgaWYgKGNpcGhlciAmJiBzYXZlSW5WYXVsdCkge1xuICAgICAgICAgICAgICBhY2NvdW50VG9TYXZlID0gYWNjb3VudHMuc2V0VmF1bHRDaXBoZXJSZWxhdGlvbnNoaXAoYWNjb3VudFRvU2F2ZSwgY2lwaGVyLmlkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGxvZ2dlci53YXJuKFwiTm8gY2lwaGVyIHBhc3NlZCB3aGVuIGNyZWF0aW5nL3VwZGF0aW5nIGFjY291bnQsIGFjY291bnQgd2lsbCBub3QgYmUgbGlua2VkIHRvIGNpcGhlclwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI0O1xuICAgICAgICAgICAgcmV0dXJuIF9zYXZlQWNjb3VudChjbGllbnQsIGtvbm5lY3RvciwgYWNjb3VudFRvU2F2ZSk7XG5cbiAgICAgICAgICBjYXNlIDI0OlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBfY29udGV4dC5zZW50KTtcblxuICAgICAgICAgIGNhc2UgMjU6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUpO1xuICB9KSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZU9yVXBkYXRlQWNjb3VudChfeCkge1xuICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xufSgpO1xuLyoqXG4gKiBFdmVudCBodWIgdG8gbGF1bmNoIGFuZCBmb2xsb3cgYSBrb25uZWN0b3Igam9iLlxuICpcbiAqIC0gQ3JlYXRlcyB0aGUgam9iIGZvciBhIHRyaWdnZXJcbiAqIC0gTGlzdGVucyB0byBjaGFuZ2VzIG9uXG4gKiAgIC0gdGhlIGNyZWF0ZWQgam9iXG4gKiAgIC0gdGhlIGFjY291bnQgbGlua2VkIHRvIHRoZSB0cmlnZ2VyXG4gKlxuICogVHJhbnNmb3JtcyBsb3ctbGV2ZWwgZXZlbnRzIGhhcHBlbmluZyBvbiB0aGUgZG9jdW1lbnRzIHRvIGhpZ2hlci1sZXZlbCBldmVudHNcbiAqIGNsb3NlciB0byBidXNpbmVzcyBsb2dpYy5cbiAqXG4gKiBUaGlzIHNob3VsZCBiZSB0aGUgZ28gdG8gc291cmNlIG9mIHRydXRoIGZvciB0aGUgc3RhdGUgb2YgYSBLb25uZWN0b3IgSm9iLlxuICovXG5cbmV4cG9ydCB2YXIgQ29ubmVjdGlvbkZsb3cgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDb25uZWN0aW9uRmxvdyhjbGllbnQsIHRyaWdnZXIsIGtvbm5lY3Rvcikge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb25uZWN0aW9uRmxvdyk7XG5cbiAgICB0aGlzLmNsaWVudCA9IGNsaWVudDtcbiAgICB0aGlzLnRyaWdnZXIgPSB0cmlnZ2VyO1xuICAgIHRoaXMua29ubmVjdG9yID0ga29ubmVjdG9yO1xuICAgIHRoaXMudW5zdWJzY3JpYmVBbGxSZWFsdGltZSA9IG51bGw7IC8vIEJpbmQgbWV0aG9kcyB1c2VkIGFzIGNhbGxiYWNrc1xuXG4gICAgdGhpcy5nZXRUd29GQUNvZGVQcm92aWRlciA9IHRoaXMuZ2V0VHdvRkFDb2RlUHJvdmlkZXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLmdldEtvbm5lY3RvclNsdWcgPSB0aGlzLmdldEtvbm5lY3RvclNsdWcuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZUFjY291bnRVcGRhdGVkID0gdGhpcy5oYW5kbGVBY2NvdW50VXBkYXRlZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlSm9iVXBkYXRlZCA9IHRoaXMuaGFuZGxlSm9iVXBkYXRlZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlQWNjb3VudFR3b0ZBID0gdGhpcy5oYW5kbGVBY2NvdW50VHdvRkEuYmluZCh0aGlzKTtcbiAgICB0aGlzLmxhdW5jaCA9IHRoaXMubGF1bmNoLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZW5kVHdvRkFDb2RlID0gdGhpcy5zZW5kVHdvRkFDb2RlLmJpbmQodGhpcyk7XG4gICAgdGhpcy51bndhdGNoID0gdGhpcy51bndhdGNoLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHN0YXR1czogSURMRVxuICAgIH07IC8vIFN0b3JlcyBkYXRhIG5lY2Vzc2FyeSBmb3IgY3VzdG9tIGNvbm5lY3Rpb24gZmxvdywgZm9yIGV4YW1wbGVcbiAgICAvLyBhIGJ1ZGdldC1pbnNpZ2h0IHRlbXBvcmFyeSB0b2tlblxuXG4gICAgdGhpcy5kYXRhID0ge307XG4gICAgdGhpcy50d29GQVdhaXRlcnMgPSB0aGlzLnR3b0ZBV2FpdGVycyB8fCBbXTtcbiAgICB0aGlzLnJlYWx0aW1lID0gbmV3IFJlYWx0aW1lKHtcbiAgICAgIGNsaWVudDogY2xpZW50XG4gICAgfSk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoQ29ubmVjdGlvbkZsb3csIFt7XG4gICAga2V5OiBcImdldFR3b0ZBQ29kZVByb3ZpZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldFR3b0ZBQ29kZVByb3ZpZGVyKCkge1xuICAgICAgcmV0dXJuIGFjY291bnRzLmdldFR3b0ZBQ29kZVByb3ZpZGVyKHRoaXMuYWNjb3VudCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImdldEtvbm5lY3RvclNsdWdcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0S29ubmVjdG9yU2x1ZygpIHtcbiAgICAgIHJldHVybiB0aGlzLnRyaWdnZXIubWVzc2FnZS5rb25uZWN0b3I7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImhhbmRsZUFjY291bnRUd29GQVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVBY2NvdW50VHdvRkEocHJldkFjY291bnQpIHtcbiAgICAgIHZhciBhY2NvdW50ID0gdGhpcy5hY2NvdW50O1xuICAgICAgdmFyIHByZXZTdGF0ZSA9IHByZXZBY2NvdW50ICYmIHByZXZBY2NvdW50LnN0YXRlO1xuICAgICAgdmFyIHN0YXRlID0gYWNjb3VudC5zdGF0ZTtcbiAgICAgIHJldHVybiB0aGlzLmhhbmRsZVR3b0ZBU3RhdGVDaGFuZ2Uoc3RhdGUsIHByZXZTdGF0ZSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImhhbmRsZVR3b0ZBU3RhdGVDaGFuZ2VcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlVHdvRkFTdGF0ZUNoYW5nZShzdGF0ZSkge1xuICAgICAgdmFyIHByZXZTdGF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDtcblxuICAgICAgaWYgKHByZXZTdGF0ZSA9PT0gc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoYWNjb3VudHMuaXNUd29GQU5lZWRlZChzdGF0ZSkpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgc3RhdHVzOiBUV09fRkFfUkVRVUVTVFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lbWl0KFRXT19GQV9SRVFVRVNUX0VWRU5UKTtcbiAgICAgIH0gZWxzZSBpZiAoYWNjb3VudHMuaXNUd29GQVJldHJ5KHN0YXRlKSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBzdGF0dXM6IFRXT19GQV9NSVNNQVRDSFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lbWl0KFRXT19GQV9NSVNNQVRDSF9FVkVOVCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInRyaWdnZXJFdmVudFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0cmlnZ2VyRXZlbnQoZXZlbnROYW1lKSB7XG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgICAgfVxuXG4gICAgICBsb2dnZXIuZGVidWcoXCJDb25uZWN0aW9uRmxvdzogdHJpZ2dlckV2ZW50IFwiLmNvbmNhdChldmVudE5hbWUpLCBhcmdzKTtcblxuICAgICAgaWYgKGlzU3RlcEV2ZW50KGV2ZW50TmFtZSkpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShfZGVmaW5lUHJvcGVydHkoe30sIGV2ZW50TmFtZSwgdHJ1ZSkpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXZlbnRUb1N0YXR1c1tldmVudE5hbWVdKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZyhcIkNvbm5lY3Rpb25GbG93OiBTZXR0aW5nIHN0YXR1cyBcIi5jb25jYXQoZXZlbnRUb1N0YXR1c1tldmVudE5hbWVdKSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIHN0YXR1czogZXZlbnRUb1N0YXR1c1tldmVudE5hbWVdXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXZlbnROYW1lID09PSBFUlJPUl9FVkVOVCkge1xuICAgICAgICB0aGlzLnJlZmV0Y2hUcmlnZ2VyKCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBbZXZlbnROYW1lXS5jb25jYXQoYXJncykpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJnZXRBY2NvdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFjY291bnQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5hY2NvdW50O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzYXZlVHdvRkFSZXF1ZXN0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfc2F2ZVR3b0ZBUmVxdWVzdCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKHR3b0ZBUmVxdWVzdE9wdGlvbnMpIHtcbiAgICAgICAgdmFyIGFjY291bnQ7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcIlNhdmluZyAyRkEgcmVxdWVzdFwiLCB0d29GQVJlcXVlc3RPcHRpb25zKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgIHN0YXR1czogV0FJVElOR19UV09GQVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMjtcbiAgICAgICAgICAgICAgICBhY2NvdW50ID0gYWNjb3VudHMudXBkYXRlVHdvRkFTdGF0ZSh0aGlzLmFjY291bnQsIHR3b0ZBUmVxdWVzdE9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNjtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zYXZlQWNjb3VudChhY2NvdW50KTtcblxuICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyRXZlbnQoVFdPX0ZBX1JFUVVFU1RfRVZFTlQsIHR3b0ZBUmVxdWVzdE9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gOTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbXCJjYXRjaFwiXSgyKTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoX2NvbnRleHQyLnQwKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgIHN0YXR1czogRVJST1JFRCxcbiAgICAgICAgICAgICAgICAgIGVycm9yOiBfY29udGV4dDIudDBcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcywgW1syLCA5XV0pO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBzYXZlVHdvRkFSZXF1ZXN0KF94Mikge1xuICAgICAgICByZXR1cm4gX3NhdmVUd29GQVJlcXVlc3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHNhdmVUd29GQVJlcXVlc3Q7XG4gICAgfSgpXG4gICAgLyoqXG4gICAgICogV2FpdHMgdW50aWwgdHdvIGZhIGNvZGUgaGFzIGJlZW4gc2VudFxuICAgICAqXG4gICAgICogLSBNb25pdG9ycyB0aGUgYWNjb3VudCAoZm9yIHRoZSBjYXNlIHdoZXJlIHRoZSAyRkEgY29kZSBpcyBmaWxsZWQgYnkgdGhlIGtvbm5lY3RvciBqb2IpXG4gICAgICogLSBTdWJzY3JpYmVzIGEgXCJtYW51YWxcIiB3YWl0ZXIgZm9yIHdoZW4gdGhlIDJGQSBpcyBkb25lIGNvbXBsZXRlbHkgaW4tYnJvd3NlciAoYnVkZ2V0LWluc2lnaHRcbiAgICAgKiAgIGZvciBleGFtcGxlKVxuICAgICAqXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJ3YWl0Rm9yVHdvRkFcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gd2FpdEZvclR3b0ZBKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgbG9nZ2VyLmluZm8oXCJDb25uZWN0aW9uRmxvdzogV2FpdGluZyBmb3IgdHdvIEZBXCIpO1xuXG4gICAgICBpZiAodGhpcy5qb2JXYXRjaGVyKSB7XG4gICAgICAgIHRoaXMuam9iV2F0Y2hlci5kaXNhYmxlU3VjY2Vzc1RpbWVyKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmF3UmVzb2x2ZSkge1xuICAgICAgICB2YXIgYWNjb3VudElkID0gX3RoaXMuYWNjb3VudC5faWQ7XG4gICAgICAgIGFzc2VydChhY2NvdW50SWQsIFwiQ2Fubm90IHdhaXQgZm9yIHR3byBmYSBvbiBhY2NvdW50IHdpdGhvdXQgaWRcIik7XG5cbiAgICAgICAgdmFyIHJlc29sdmUgPSBmdW5jdGlvbiByZXNvbHZlKCkge1xuICAgICAgICAgIF90aGlzLnJlYWx0aW1lLnVuc3Vic2NyaWJlKFwidXBkYXRlZFwiLCBBQ0NPVU5UU19ET0NUWVBFLCBhY2NvdW50SWQsIGhhbmRsZUFjY291bnRVcGRhdGUpO1xuXG4gICAgICAgICAgcmF3UmVzb2x2ZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBoYW5kbGVBY2NvdW50VXBkYXRlID0gZnVuY3Rpb24gaGFuZGxlQWNjb3VudFVwZGF0ZShhY2NvdW50KSB7XG4gICAgICAgICAgaWYgKGFjY291bnQgJiYgYWNjb3VudC50d29GQUNvZGUpIHtcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHVwZGF0ZUZyb21DdXN0b21Qb2xpY3kgPSBmdW5jdGlvbiB1cGRhdGVGcm9tQ3VzdG9tUG9saWN5KCkge1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBfdGhpcy50d29GQVdhaXRlcnMucHVzaCh1cGRhdGVGcm9tQ3VzdG9tUG9saWN5KTtcblxuICAgICAgICBfdGhpcy5yZWFsdGltZS5zdWJzY3JpYmUoXCJ1cGRhdGVkXCIsIEFDQ09VTlRTX0RPQ1RZUEUsIGFjY291bnRJZCwgaGFuZGxlQWNjb3VudFVwZGF0ZSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2F2ZXMgYW5kIHVwZGF0ZXMgaW50ZXJuYWwgYWNjb3VudFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwic2F2ZUFjY291bnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9zYXZlQWNjb3VudDIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyh1cGRhdGVkQWNjb3VudCkge1xuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoXCJDb25uZWN0aW9uRmxvdzogU2F2aW5nIGFjY291bnRcIik7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzO1xuICAgICAgICAgICAgICAgIHJldHVybiBfc2F2ZUFjY291bnQodGhpcy5jbGllbnQsIHRoaXMua29ubmVjdG9yLCB1cGRhdGVkQWNjb3VudCk7XG5cbiAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHRoaXMuYWNjb3VudCA9IF9jb250ZXh0My5zZW50O1xuICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKFwiQ29ubmVjdGlvbkZsb3c6IFNhdmVkIGFjY291bnRcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoXCJyZXR1cm5cIiwgdGhpcy5hY2NvdW50KTtcblxuICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWUzLCB0aGlzKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gc2F2ZUFjY291bnQoX3gzKSB7XG4gICAgICAgIHJldHVybiBfc2F2ZUFjY291bnQyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzYXZlQWNjb3VudDtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJmbHVzaFR3b0ZBV2FpdGVyc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBmbHVzaFR3b0ZBV2FpdGVycygpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhcIkNvbm5lY3Rpb25GbG93OiBGbHVzaGluZyBcIi5jb25jYXQodGhpcy50d29GQVdhaXRlcnMubGVuZ3RoLCBcIiB0d28gZmEgd2FpdGVyc1wiKSk7XG5cbiAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLnR3b0ZBV2FpdGVycyksXG4gICAgICAgICAgX3N0ZXA7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7XG4gICAgICAgICAgdmFyIGNhbGxiYWNrID0gX3N0ZXAudmFsdWU7XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIF9pdGVyYXRvci5lKGVycik7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBfaXRlcmF0b3IuZigpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnR3b0ZBV2FpdGVycyA9IFtdO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZW5kQWRkaXRpb25hbEluZm9ybWF0aW9uXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfc2VuZEFkZGl0aW9uYWxJbmZvcm1hdGlvbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KGZpZWxkcykge1xuICAgICAgICB2YXIga29ubmVjdG9yUG9saWN5O1xuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgIHN0YXR1czogUlVOTklOR19UV09GQVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMTtcbiAgICAgICAgICAgICAgICBrb25uZWN0b3JQb2xpY3kgPSB0aGlzLmdldEtvbm5lY3RvclBvbGljeSgpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNTtcbiAgICAgICAgICAgICAgICByZXR1cm4ga29ubmVjdG9yUG9saWN5LnNlbmRBZGRpdGlvbmFsSW5mb3JtYXRpb24odGhpcywgZmllbGRzKTtcblxuICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgdGhpcy5mbHVzaFR3b0ZBV2FpdGVycygpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gODtcbiAgICAgICAgICAgICAgICBfY29udGV4dDQudDAgPSBfY29udGV4dDRbXCJjYXRjaFwiXSgxKTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoX2NvbnRleHQ0LnQwKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgIHN0YXR1czogRVJST1JFRCxcbiAgICAgICAgICAgICAgICAgIGVycm9yOiBfY29udGV4dDQudDBcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcywgW1sxLCA4XV0pO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBzZW5kQWRkaXRpb25hbEluZm9ybWF0aW9uKF94NCkge1xuICAgICAgICByZXR1cm4gX3NlbmRBZGRpdGlvbmFsSW5mb3JtYXRpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHNlbmRBZGRpdGlvbmFsSW5mb3JtYXRpb247XG4gICAgfSgpXG4gICAgLyoqXG4gICAgICogXCJTZW5kc1wiIDJGQSBDb2RlXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJzZW5kVHdvRkFDb2RlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfc2VuZFR3b0ZBQ29kZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KGNvZGUpIHtcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICBzdGF0dXM6IFJVTk5JTkdfVFdPRkFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDUucHJldiA9IDE7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKFwiQ29ubmVjdGlvbkZsb3c6IFNlbmRpbmcgdHdvIGZhIGNvZGUgXCIuY29uY2F0KGNvZGUpKTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZUFjY291bnQoYWNjb3VudHMudXBkYXRlVHdvRmFDb2RlKHRoaXMuYWNjb3VudCwgY29kZSkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDExO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICBfY29udGV4dDUucHJldiA9IDc7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ1LnQwID0gX2NvbnRleHQ1W1wiY2F0Y2hcIl0oMSk7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoX2NvbnRleHQ1LnQwKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgIHN0YXR1czogRVJST1JFRCxcbiAgICAgICAgICAgICAgICAgIGVycm9yOiBfY29udGV4dDUudDBcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcywgW1sxLCA3XV0pO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBzZW5kVHdvRkFDb2RlKF94NSkge1xuICAgICAgICByZXR1cm4gX3NlbmRUd29GQUNvZGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHNlbmRUd29GQUNvZGU7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwiaGFuZGxlTG9naW5TdWNjZXNzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZUxvZ2luU3VjY2VzcygpIHtcbiAgICAgIHRoaXMuam9iV2F0Y2hlci5oYW5kbGVTdWNjZXNzKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImhhbmRsZUxvZ2luU3VjY2Vzc0hhbmRsZWRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlTG9naW5TdWNjZXNzSGFuZGxlZCgpIHtcbiAgICAgIHRoaXMuam9iV2F0Y2hlci5kaXNhYmxlU3VjY2Vzc1RpbWVyKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIC0gQ3JlYXRlcyBpby5jb3p5LmFjY291bnRzXG4gICAgICogLSBMaW5rcyBjaXBoZXIgdG8gYWNjb3VudFxuICAgICAqIC0gU2F2ZXMgYWNjb3VudFxuICAgICAqIC0gRW5zdXJlcyB0cmlnZ2VyIGlzIGV4aXN0aW5nIGZvciBhY2NvdW50XG4gICAgICogLSBGaW5kcyBjaXBoZXIgdmlhIGlkZW50aWZpZXIgLyBwYXNzd29yZFxuICAgICAqIC0gRW5zdXJlcyBhIGNpcGhlciBpcyBjcmVhdGVkIGlmIHZhdWx0IGlzIHVubG9ja2VkXG4gICAgICogLSBMYXVuY2hlcyBrb25uZWN0b3Igam9iXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJoYW5kbGVGb3JtU3VibWl0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfaGFuZGxlRm9ybVN1Ym1pdCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIGtvbm5lY3RvciwgY2lwaGVySWQsIHZhdWx0Q2xpZW50LCB1c2VyQ3JlZGVudGlhbHMsIHQsIGFjY291bnQsIHRyaWdnZXIsIGNsaWVudCwga29ubmVjdG9yUG9saWN5LCBjaXBoZXI7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0Nikge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGtvbm5lY3RvciA9IG9wdGlvbnMua29ubmVjdG9yLCBjaXBoZXJJZCA9IG9wdGlvbnMuY2lwaGVySWQsIHZhdWx0Q2xpZW50ID0gb3B0aW9ucy52YXVsdENsaWVudCwgdXNlckNyZWRlbnRpYWxzID0gb3B0aW9ucy51c2VyQ3JlZGVudGlhbHMsIHQgPSBvcHRpb25zLnQ7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSAxO1xuICAgICAgICAgICAgICAgIGFjY291bnQgPSBvcHRpb25zLmFjY291bnQsIHRyaWdnZXIgPSBvcHRpb25zLnRyaWdnZXI7XG4gICAgICAgICAgICAgICAgY2xpZW50ID0gdGhpcy5jbGllbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICBzdGF0dXM6IENSRUFUSU5HX0FDQ09VTlRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIgPSB0cmlnZ2VyO1xuICAgICAgICAgICAgICAgIHRoaXMuYWNjb3VudCA9IGFjY291bnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5rb25uZWN0b3IgPSBrb25uZWN0b3I7XG4gICAgICAgICAgICAgICAgdGhpcy50ID0gdDtcbiAgICAgICAgICAgICAgICBhc3NlcnQoY2xpZW50LCBcIk5vIGNsaWVudFwiKTtcbiAgICAgICAgICAgICAgICBrb25uZWN0b3JQb2xpY3kgPSBmaW5kS29ubmVjdG9yUG9saWN5KGtvbm5lY3Rvcik7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhcIkNvbm5lY3Rpb25GbG93OiBIYW5kbGluZyBzdWJtaXQsIHdpdGgga29ubmVjdG9yIHBvbGljeSBcIi5jb25jYXQoa29ubmVjdG9yUG9saWN5Lm5hbWUpKTtcblxuICAgICAgICAgICAgICAgIGlmICgha29ubmVjdG9yUG9saWN5LnNhdmVJblZhdWx0KSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE4O1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxNTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlT3JVcGRhdGVDaXBoZXIodmF1bHRDbGllbnQsIGNpcGhlcklkLCB7XG4gICAgICAgICAgICAgICAgICBhY2NvdW50OiBhY2NvdW50LFxuICAgICAgICAgICAgICAgICAga29ubmVjdG9yOiBrb25uZWN0b3IsXG4gICAgICAgICAgICAgICAgICB1c2VyQ3JlZGVudGlhbHM6IHVzZXJDcmVkZW50aWFsc1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAgICAgY2lwaGVyID0gX2NvbnRleHQ2LnNlbnQ7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxOTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKFwiQ29ubmVjdGlvbkZsb3c6IEJ5cGFzc2luZyBjaXBoZXIgY3JlYXRpb24gYmVjYXVzZSBvZiBrb25uZWN0b3IgYWNjb3VudCBwb2xpY3lcIik7XG5cbiAgICAgICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoXCJDb25uZWN0aW9uRmxvdzogQ3JlYXRpbmcvdXBkYXRpbmcgYWNjb3VudC4uLlwiLCBhY2NvdW50KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDIyO1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVPclVwZGF0ZUFjY291bnQoe1xuICAgICAgICAgICAgICAgICAgYWNjb3VudDogYWNjb3VudCxcbiAgICAgICAgICAgICAgICAgIGNpcGhlcjogY2lwaGVyLFxuICAgICAgICAgICAgICAgICAgY2xpZW50OiBjbGllbnQsXG4gICAgICAgICAgICAgICAgICBmbG93OiB0aGlzLFxuICAgICAgICAgICAgICAgICAga29ubmVjdG9yOiBrb25uZWN0b3IsXG4gICAgICAgICAgICAgICAgICBrb25uZWN0b3JQb2xpY3k6IGtvbm5lY3RvclBvbGljeSxcbiAgICAgICAgICAgICAgICAgIHVzZXJDcmVkZW50aWFsczogdXNlckNyZWRlbnRpYWxzXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyMjpcbiAgICAgICAgICAgICAgICBhY2NvdW50ID0gX2NvbnRleHQ2LnNlbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5hY2NvdW50ID0gYWNjb3VudDtcbiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhcIkNvbm5lY3Rpb25GbG93OiBTYXZlZCBhY2NvdW50IFwiLmNvbmNhdChhY2NvdW50Ll9pZCkpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW5zdXJlVHJpZ2dlckFuZExhdW5jaChjbGllbnQsIHtcbiAgICAgICAgICAgICAgICAgIHRyaWdnZXI6IHRyaWdnZXIsXG4gICAgICAgICAgICAgICAgICBhY2NvdW50OiBhY2NvdW50LFxuICAgICAgICAgICAgICAgICAga29ubmVjdG9yOiBrb25uZWN0b3IsXG4gICAgICAgICAgICAgICAgICB0OiB0XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgIGFjY291bnRFcnJvcjogbnVsbFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAzMDpcbiAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDMwO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Ni50MCA9IF9jb250ZXh0NltcImNhdGNoXCJdKDEpO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihfY29udGV4dDYudDApO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgYWNjb3VudEVycm9yOiBfY29udGV4dDYudDBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXJFdmVudChFUlJPUl9FVkVOVCwgX2NvbnRleHQ2LnQwKTtcbiAgICAgICAgICAgICAgICBzZW50cnlIdWIud2l0aFNjb3BlKGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgICAgICAgc2NvcGUuc2V0VGFnKFwia29ubmVjdG9yXCIsIGtvbm5lY3Rvci5zbHVnKTsgLy8gQ2FwdHVyZSB0aGUgb3JpZ2luYWwgZXhjZXB0aW9uIGluc3RlYWQgb2YgdGhlIHVzZXIgb25lXG5cbiAgICAgICAgICAgICAgICAgIHNlbnRyeUh1Yi5jYXB0dXJlRXhjZXB0aW9uKF9jb250ZXh0Ni50MC5vcmlnaW5hbCB8fCBfY29udGV4dDYudDApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRocm93IF9jb250ZXh0Ni50MDtcblxuICAgICAgICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlNiwgdGhpcywgW1sxLCAzMF1dKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdChfeDYpIHtcbiAgICAgICAgcmV0dXJuIF9oYW5kbGVGb3JtU3VibWl0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBoYW5kbGVGb3JtU3VibWl0O1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcImhhbmRsZUFjY291bnRVcGRhdGVkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZUFjY291bnRVcGRhdGVkKGFjY291bnQpIHtcbiAgICAgIHZhciBwcmV2QWNjb3VudCA9IHRoaXMuYWNjb3VudDsgLy8gX3R5cGUgaXMgbm90IHByZXNlbnQgaW4gb2JqZWN0cyBmcm9tIHJlYWx0aW1lIGJ1dCB3ZSBoYXZlIHRvIGtlZXBcbiAgICAgIC8vIGl0IHRvIGJlIGNvbXBhdGlibGUgd2l0aCBjb3p5LWNsaWVudCdzIG1ldGhvZHNcbiAgICAgIC8vXG5cbiAgICAgIHRoaXMuYWNjb3VudCA9IF9vYmplY3RTcHJlYWQoe1xuICAgICAgICBfdHlwZTogcHJldkFjY291bnQuX3R5cGVcbiAgICAgIH0sIGFjY291bnQpO1xuICAgICAgdmFyIHN0YXRlID0gdGhpcy5hY2NvdW50LnN0YXRlO1xuXG4gICAgICBpZiAoYWNjb3VudHMuaXNUd29GQU5lZWRlZChzdGF0ZSkgfHwgYWNjb3VudHMuaXNUd29GQVJldHJ5KHN0YXRlKSkge1xuICAgICAgICB0aGlzLmhhbmRsZUFjY291bnRUd29GQShwcmV2QWNjb3VudCk7XG4gICAgICB9IGVsc2UgaWYgKGFjY291bnRzLmlzTG9naW5TdWNjZXNzSGFuZGxlZChzdGF0ZSkpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVMb2dpblN1Y2Nlc3NIYW5kbGVkKCk7XG4gICAgICB9IGVsc2UgaWYgKGFjY291bnRzLmlzTG9naW5TdWNjZXNzKHN0YXRlKSkge1xuICAgICAgICB0aGlzLmhhbmRsZUxvZ2luU3VjY2VzcygpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJoYW5kbGVKb2JVcGRhdGVkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfaGFuZGxlSm9iVXBkYXRlZCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkge1xuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoXCJDb25uZWN0aW9uRmxvdzogSGFuZGxpbmcgdXBkYXRlIGZyb20gam9iXCIpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWZldGNoVHJpZ2dlcigpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTcsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBoYW5kbGVKb2JVcGRhdGVkKCkge1xuICAgICAgICByZXR1cm4gX2hhbmRsZUpvYlVwZGF0ZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGhhbmRsZUpvYlVwZGF0ZWQ7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwicmVmZXRjaFRyaWdnZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9yZWZldGNoVHJpZ2dlciA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkge1xuICAgICAgICB2YXIgdHJpZ2dlcjtcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHJpZ2dlcikge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoXCJyZXR1cm5cIiwgbnVsbCk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcIkNvbm5lY3Rpb25GbG93OiBSZWZldGNoaW5nIHRyaWdnZXIgIFwiLmNvbmNhdCh0aGlzLnRyaWdnZXIuX2lkKSk7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSA1O1xuICAgICAgICAgICAgICAgIHJldHVybiBmZXRjaFRyaWdnZXIodGhpcy5jbGllbnQsIHRoaXMudHJpZ2dlci5faWQpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICB0cmlnZ2VyID0gX2NvbnRleHQ4LnNlbnQ7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKFwiUmVmZXRjaGVkIHRyaWdnZXJcIiwgdHJpZ2dlcik7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyID0gdHJpZ2dlcjtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoVVBEQVRFX0VWRU5UKTtcblxuICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWU4LCB0aGlzKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gcmVmZXRjaFRyaWdnZXIoKSB7XG4gICAgICAgIHJldHVybiBfcmVmZXRjaFRyaWdnZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlZmV0Y2hUcmlnZ2VyO1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcImVuc3VyZVRyaWdnZXJBbmRMYXVuY2hcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9lbnN1cmVUcmlnZ2VyQW5kTGF1bmNoID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoY2xpZW50LCBfcmVmMykge1xuICAgICAgICB2YXIgdHJpZ2dlciwgYWNjb3VudCwga29ubmVjdG9yLCB0LCBlbnN1cmVkVHJpZ2dlcjtcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgdHJpZ2dlciA9IF9yZWYzLnRyaWdnZXIsIGFjY291bnQgPSBfcmVmMy5hY2NvdW50LCBrb25uZWN0b3IgPSBfcmVmMy5rb25uZWN0b3IsIHQgPSBfcmVmMy50O1xuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcIkNvbm5lY3Rpb25GbG93OiBFbnN1cmluZyB0cmlnZ2VyLi4uXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMudCA9IHQ7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA1O1xuICAgICAgICAgICAgICAgIHJldHVybiBlbnN1cmVUcmlnZ2VyKGNsaWVudCwge1xuICAgICAgICAgICAgICAgICAgdHJpZ2dlcjogdHJpZ2dlcixcbiAgICAgICAgICAgICAgICAgIGFjY291bnQ6IGFjY291bnQsXG4gICAgICAgICAgICAgICAgICBrb25uZWN0b3I6IGtvbm5lY3RvcixcbiAgICAgICAgICAgICAgICAgIHQ6IHRcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgZW5zdXJlZFRyaWdnZXIgPSBfY29udGV4dDkuc2VudDtcbiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhcIlRyaWdnZXIgaXMgXCIuY29uY2F0KGVuc3VyZWRUcmlnZ2VyLl9pZCkpO1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlciA9IGVuc3VyZWRUcmlnZ2VyO1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdChVUERBVEVfRVZFTlQpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMTE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGF1bmNoKCk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTksIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBlbnN1cmVUcmlnZ2VyQW5kTGF1bmNoKF94NywgX3g4KSB7XG4gICAgICAgIHJldHVybiBfZW5zdXJlVHJpZ2dlckFuZExhdW5jaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZW5zdXJlVHJpZ2dlckFuZExhdW5jaDtcbiAgICB9KClcbiAgICAvKipcbiAgICAgKiBMYXVuY2hlcyB0aGUgam9iIGFuZCBzZXRzIGV2ZXJ5dGhpbmcgdXAgdG8gZm9sbG93IGV4ZWN1dGlvbi5cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImxhdW5jaFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX2xhdW5jaCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMCgpIHtcbiAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgdmFyIF9yZWY0LFxuICAgICAgICAgICAgX3JlZjQkYXV0b1N1Y2Nlc3NUaW1lLFxuICAgICAgICAgICAgYXV0b1N1Y2Nlc3NUaW1lcixcbiAgICAgICAgICAgIGNsaWVudFNpZGVTbHVncyxcbiAgICAgICAgICAgIF9pdGVyYXRvcjIsXG4gICAgICAgICAgICBfc3RlcDIsXG4gICAgICAgICAgICBfbG9vcCxcbiAgICAgICAgICAgIF9hcmdzMTAgPSBhcmd1bWVudHM7XG5cbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIF9yZWY0ID0gX2FyZ3MxMC5sZW5ndGggPiAwICYmIF9hcmdzMTBbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTBbMF0gOiB7fSwgX3JlZjQkYXV0b1N1Y2Nlc3NUaW1lID0gX3JlZjQuYXV0b1N1Y2Nlc3NUaW1lciwgYXV0b1N1Y2Nlc3NUaW1lciA9IF9yZWY0JGF1dG9TdWNjZXNzVGltZSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWY0JGF1dG9TdWNjZXNzVGltZTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhcIkNvbm5lY3Rpb25GbG93OiBMYXVuY2hpbmcgam9iLi4uXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgc3RhdHVzOiBQRU5ESU5HXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJlcGFyZVRyaWdnZXJBY2NvdW50KHRoaXMuY2xpZW50LCB0aGlzLnRyaWdnZXIpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICB0aGlzLmFjY291bnQgPSBfY29udGV4dDEwLnNlbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWFsdGltZS5zdWJzY3JpYmUoXCJ1cGRhdGVkXCIsIEFDQ09VTlRTX0RPQ1RZUEUsIHRoaXMuYWNjb3VudC5faWQsIHRoaXMuaGFuZGxlQWNjb3VudFVwZGF0ZWQpO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKFwiQ29ubmVjdGlvbkZsb3c6IFN1YnNjcmliZWQgdG8gXCIuY29uY2F0KEFDQ09VTlRTX0RPQ1RZUEUsIFwiOlwiKS5jb25jYXQodGhpcy5hY2NvdW50Ll9pZCkpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDEwO1xuICAgICAgICAgICAgICAgIHJldHVybiBsYXVuY2hUcmlnZ2VyKHRoaXMuY2xpZW50LCB0aGlzLnRyaWdnZXIpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgdGhpcy5qb2IgPSBfY29udGV4dDEwLnNlbnQ7XG4gICAgICAgICAgICAgICAgY2xpZW50U2lkZVNsdWdzID0gZ2V0KHdpbmRvdywgXCJjb3p5LmNsaWVudFNpZGVTbHVnc1wiLCBbXSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2xpZW50U2lkZVNsdWdzLmluY2x1ZGVzKHRoaXMua29ubmVjdG9yLnNsdWcpKSB7XG4gICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhcIlRoaXMgY29ubmVjdG9yIGNhbiBiZSBydW4gYnkgdGhlIGxhdW5jaGVyXCIsIHRoaXMua29ubmVjdG9yLnNsdWcpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoZ2V0KHdpbmRvdywgXCJjb3p5LkNsaWVudENvbm5lY3RvckxhdW5jaGVyXCIpID09PSBcInJlYWN0LW5hdGl2ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKFwiRm91bmQgY2xpZW50IGNvbm5lY3RvciByZWFjdC1uYXRpdmUgbGF1bmNoZXJcIik7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5SZWFjdE5hdGl2ZVdlYlZpZXcucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwic3RhcnRMYXVuY2hlclwiLFxuICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0b3I6IHRoaXMua29ubmVjdG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudDogdGhpcy5hY2NvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcjogdGhpcy50cmlnZ2VyLFxuICAgICAgICAgICAgICAgICAgICAgICAgam9iOiB0aGlzLmpvYlxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oXCJGb3VuZCBubyBjbGllbnQgY29ubmVjdG9yIGxhdW5jaGVyXCIpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMucmVhbHRpbWUuc3Vic2NyaWJlKFwidXBkYXRlZFwiLCBKT0JTX0RPQ1RZUEUsIHRoaXMuam9iLl9pZCwgdGhpcy5oYW5kbGVKb2JVcGRhdGVkLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIHRoaXMuam9iV2F0Y2hlciA9IHdhdGNoS29ubmVjdG9ySm9iKHRoaXMuY2xpZW50LCB0aGlzLmpvYiwge1xuICAgICAgICAgICAgICAgICAgYXV0b1N1Y2Nlc3NUaW1lcjogYXV0b1N1Y2Nlc3NUaW1lclxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKFwiQ29ubmVjdGlvbkZsb3c6IFN1YnNjcmliZWQgdG8gXCIuY29uY2F0KEpPQlNfRE9DVFlQRSwgXCI6XCIpLmNvbmNhdCh0aGlzLmpvYi5faWQpKTtcbiAgICAgICAgICAgICAgICBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoSk9CX0VWRU5UUyk7XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ID0gX3N0ZXAyLnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5qb2JXYXRjaGVyLm9uKGV2LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07XG4gICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi50cmlnZ2VyRXZlbnQuYXBwbHkoX3RoaXMyLCBbZXZdLmNvbmNhdChhcmdzKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvb3AoKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIuZShlcnIpO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICBfaXRlcmF0b3IyLmYoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlQWxsUmVhbHRpbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczIuam9iV2F0Y2hlci51bnN1YnNjcmliZUFsbCgpO1xuXG4gICAgICAgICAgICAgICAgICBfdGhpczIucmVhbHRpbWUudW5zdWJzY3JpYmVBbGwoKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIGNhc2UgMTk6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlMTAsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBsYXVuY2goKSB7XG4gICAgICAgIHJldHVybiBfbGF1bmNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBsYXVuY2g7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwidW53YXRjaFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB1bndhdGNoKCkge1xuICAgICAgaWYgKHR5cGVvZiB0aGlzLnVuc3Vic2NyaWJlQWxsUmVhbHRpbWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlQWxsUmVhbHRpbWUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVzZXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXQoKSB7XG4gICAgICB0aGlzLnRyaWdnZXIgPSBudWxsO1xuICAgICAgdGhpcy5qb2IgPSBudWxsO1xuICAgICAgdGhpcy5lbWl0KFVQREFURV9FVkVOVCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImdldE1vY2tFcnJvclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNb2NrRXJyb3IoKSB7XG4gICAgICByZXR1cm4gZmxhZyhcImhhcnZlc3QuZm9yY2UtbGFzdC1lcnJvclwiKSA/IG5ldyBLb25uZWN0b3JKb2JFcnJvcihmbGFnKFwiaGFydmVzdC5mb3JjZS1sYXN0LWVycm9yXCIpKSA6IG51bGw7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImdldERlcml2ZWRTdGF0ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREZXJpdmVkU3RhdGUoKSB7XG4gICAgICB2YXIgdHJpZ2dlciA9IHRoaXMudHJpZ2dlcjtcbiAgICAgIHZhciBfdGhpcyRzdGF0ZSA9IHRoaXMuc3RhdGUsXG4gICAgICAgICAgc3RhdHVzID0gX3RoaXMkc3RhdGUuc3RhdHVzLFxuICAgICAgICAgIGFjY291bnRFcnJvciA9IF90aGlzJHN0YXRlLmFjY291bnRFcnJvcjtcbiAgICAgIHZhciB0cmlnZ2VyRXJyb3IgPSB0cmlnZ2Vyc01vZGVsLmdldEtvbm5lY3RvckpvYkVycm9yKHRyaWdnZXIpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcnVubmluZzogIVtFUlJPUkVELCBJRExFLCBTVUNDRVNTXS5pbmNsdWRlcyhzdGF0dXMpLFxuICAgICAgICB0d29GQVJ1bm5pbmc6IHN0YXR1cyA9PT0gUlVOTklOR19UV09GQSxcbiAgICAgICAgdHdvRkFSZXRyeTogc3RhdHVzID09IFRXT19GQV9NSVNNQVRDSCxcbiAgICAgICAgdHJpZ2dlckVycm9yOiB0cmlnZ2VyRXJyb3IsXG4gICAgICAgIHRyaWdnZXI6IHRyaWdnZXIsXG4gICAgICAgIGFjY291bnRFcnJvcjogYWNjb3VudEVycm9yLFxuICAgICAgICBlcnJvcjogdGhpcy5nZXRNb2NrRXJyb3IoKSB8fCBhY2NvdW50RXJyb3IgfHwgdHJpZ2dlckVycm9yLFxuICAgICAgICBrb25uZWN0b3JSdW5uaW5nOiB0cmlnZ2Vyc01vZGVsLmlzS29ubmVjdG9yUnVubmluZyh0cmlnZ2VyKVxuICAgICAgfTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZ2V0U3RhdGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3RhdGUoKSB7XG4gICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLnN0YXRlKSwgdGhpcy5nZXREZXJpdmVkU3RhdGUoKSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNldFN0YXRlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldFN0YXRlKHVwZGF0ZSkge1xuICAgICAgdGhpcy5zdGF0ZSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdGhpcy5zdGF0ZSksIHVwZGF0ZSk7XG4gICAgICB0aGlzLmVtaXQoVVBEQVRFX0VWRU5UKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2V0RGF0YVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZXREYXRhKHVwZGF0ZSkge1xuICAgICAgdGhpcy5kYXRhID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLmRhdGEpLCB1cGRhdGUpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJnZXREYXRhXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5kYXRhO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJnZXRLb25uZWN0b3JQb2xpY3lcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0S29ubmVjdG9yUG9saWN5KCkge1xuICAgICAgcmV0dXJuIGZpbmRLb25uZWN0b3JQb2xpY3kodGhpcy5rb25uZWN0b3IpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJnZXRBZGRpdGlvbmFsSW5mb3JtYXRpb25OZWVkZWRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QWRkaXRpb25hbEluZm9ybWF0aW9uTmVlZGVkKCkge1xuICAgICAgdmFyIGtvbm5lY3RvclBvbGljeSA9IHRoaXMuZ2V0S29ubmVjdG9yUG9saWN5KCk7XG5cbiAgICAgIGlmICgha29ubmVjdG9yUG9saWN5KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkEga29ubmVjdG9yIHBvbGljeSBpcyBuZWVkZWQgdG8gYmUgYWJsZSB0byBkZXRlY3QgYWRkaXRpb25hbCBpbmZvcm1hdGlvblwiKTtcbiAgICAgIH0gZWxzZSBpZiAoIWtvbm5lY3RvclBvbGljeS5nZXRBZGRpdGlvbmFsSW5mb3JtYXRpb25OZWVkZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gZ2V0QWRkaXRpb25hbEluZm9ybWF0aW9uTmVlZGVkIGluIGtvbm5lY3RvciBwb2xpY3lcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgZmllbGRzID0ga29ubmVjdG9yUG9saWN5LmdldEFkZGl0aW9uYWxJbmZvcm1hdGlvbk5lZWRlZCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIGZpZWxkcztcbiAgICAgIH1cbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gQ29ubmVjdGlvbkZsb3c7XG59KCk7XG5NaWNyb0VFLm1peGluKENvbm5lY3Rpb25GbG93KTtcbmV4cG9ydCBkZWZhdWx0IENvbm5lY3Rpb25GbG93OyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/cozy-harvest-lib/dist/models/ConnectionFlow.js\n");

/***/ })

})