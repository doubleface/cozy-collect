!function(e){function t(t){for(var r,i,a=t[0],s=t[1],u=t[2],d=0,p=[];d<a.length;d++)i=a[d],o[i]&&p.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(l&&l(t);p.length;)p.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,a=1;a<n.length;a++){var s=n[a];0!==o[s]&&(r=!1)}r&&(c.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={2:0},c=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var a=window.webpackJsonp=window.webpackJsonp||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=s;c.push([4,0]),n()}({"/n/j":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_APPS":return t.apps||e;default:return e}};var r=function(e){return{type:"RECEIVE_APPS",apps:e}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.find((function(e){return e.slug===t}))}},0:function(e,t){},1:function(e,t){},2:function(e,t){},3:function(e,t){},"3dAU":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n("m+TH"),o="io.cozy.accounts",c=function(){return Object(r.g)("accounts",o)},i=function(e,t){return e.documents&&e.documents[o]?e.documents[o][t]:null},a=function(e){return e.documents&&e.documents[o]&&Object.keys(e.documents[o])||[]}},4:function(e,t,n){n("201c"),n("7NIr"),e.exports=n("d/w2")},"4DAK":function(e,t,n){"use strict";var r=n("q1tI"),o=n.n(r),c=n("6x+I"),i=n.n(c),a={Link:function(e){return o.a.createElement("a",{href:e.href,rel:"noopener noreferrer",target:"_blank"},e.children)}};t.a=function(e){var t=e.source;return o.a.createElement(i.a,{source:t,renderers:a})}},"4P+e":function(e,t,n){e.exports={"CozyTheme--normal":"CozyTheme--normal--3NV4I","coz-form-controls":"coz-form-controls--1gEYB","coz-form-controls-success":"coz-form-controls-success--1NQyf","coz-btn":"coz-btn--233oo","col-btn--regular":"col-btn--regular--2N744","col-account-form-success-buttons":"col-account-form-success-buttons--1J36i","account-form-login":"account-form-login--_w3tO","col-account-form-advanced-button":"col-account-form-advanced-button--niE6T","account-form-fieldset":"account-form-fieldset--3WD-X","col-account-success":"col-account-success--1NEI1","col-account-success-links":"col-account-success-links--15Ii5","col-account-success-link":"col-account-success-link--18QVL","col-account-success-illu":"col-account-success-illu--RvZfy"}},"4YEU":function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"p",(function(){return k})),n.d(t,"q",(function(){return _})),n.d(t,"b",(function(){return w})),n.d(t,"e",(function(){return C})),n.d(t,"g",(function(){return O})),n.d(t,"h",(function(){return T})),n.d(t,"i",(function(){return N})),n.d(t,"j",(function(){return x})),n.d(t,"d",(function(){return D})),n.d(t,"f",(function(){return S})),n.d(t,"k",(function(){return z})),n.d(t,"o",(function(){return I})),n.d(t,"l",(function(){return A})),n.d(t,"m",(function(){return L})),n.d(t,"n",(function(){return j}));var r=n("lSNA"),o=n.n(r),c=n("MVZn"),i=n.n(c),a=n("fvjX"),s=n("wd/R"),u=n.n(s),l=n("Puqe"),d=n.n(l),p=n("mwIZ"),f=n.n(p),h=n("8CvS"),y=(n("sR/t"),function(e){return e&&e.message&&e.message.konnector||null}),m=function(e){return"io.cozy.triggers"===e._type&&!!e.message&&!!e.message.konnector},g=function(e){return"io.cozy.jobs"===e._type&&"konnector"===e.worker};t.a=Object(a.combineReducers)({creation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_DATA":case"RECEIVE_NEW_DOCUMENT":if(!e)return null;if(!t.response||!t.response.data||1!==t.response.data.length)return e;var n=t.response.data[0],r="io.cozy.accounts"===n._type;if(r)return i()({},e,{account:n._id});var o=m(n);return o?i()({},e,{trigger:n._id}):e;case"START_CONNECTION_CREATION":return{};case"END_CONNECTION_CREATION":return null;default:return e}},konnectors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ENQUEUE_CONNECTION":case"UPDATE_CONNECTION_ERROR":case"UPDATE_CONNECTION_RUNNING_STATUS":case"LAUNCH_TRIGGER":if(!t.trigger||!t.trigger._id)throw new Error("Missing trigger id");if(!t.trigger.message||!t.trigger.message.konnector)throw new Error("Malformed trigger message");return i()({},e,o()({},y(t.trigger),v(e[y(t.trigger)],t)));case"RECEIVE_DATA":case"RECEIVE_NEW_DOCUMENT":return t.response&&t.response.data&&t.response.data.length?t.response.data.reduce((function(e,t){var n=m(t),r=g(t);if(!n&&!r)return e;var c=t.message.konnector,a=n&&t._id||r&&t.trigger_id;if(!a)return e;var s=n&&!!t.message&&t.message.account,u=n&&t.current_state&&t.current_state.status||r&&t.state,l=n&&!!t.current_state&&"done"!==t.current_state.status&&!!t.current_state.last_error&&Object(h.a)(t.current_state.last_error)||r&&!!t.error&&Object(h.a)(t.error)||null,d=n&&!!t.current_state&&t.current_state.last_execution||r&&t.queued_at,p=f()(e,[c,"triggers","data"],[]),y=p;return n&&(y=p.filter((function(e){return e._id!==t._id}))).push(t),i()({},e,o()({},c,{triggers:i()({},f()(e,[c,"triggers"],[]),o()({data:y},a,i()({},f()(e,[c,"triggers",a],{}),{account:s||f()(e,[c,"triggers",a,"account"]),error:l,hasError:!!l||"errored"===u,isRunning:["queued","running"].includes(u),isConnected:!l&&"done"===u,lastSyncDate:d})))}))}),e):e;case"PURGE_QUEUE":case"RECEIVE_DELETED_DOCUMENT":return Object.keys(e).reduce((function(n,r){return i()({},n,o()({},r,v(e[r],t)))}),e);default:return e}}});var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ENQUEUE_CONNECTION":case"LAUNCH_TRIGGER":case"RECEIVE_DATA":case"RECEIVE_NEW_DOCUMENT":case"RECEIVE_DELETED_DOCUMENT":case"PURGE_QUEUE":return i()({},e,{triggers:E(e.triggers,t)});default:return e}},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ENQUEUE_CONNECTION":return i()({},e,o()({},t.trigger._id,i()({},e[t.trigger._id],{isEnqueued:!0})));case"LAUNCH_TRIGGER":return i()({},e,o()({},t.trigger._id,i()({},e[t.trigger._id],{account:t.trigger.message.account,isRunning:!0})));case"PURGE_QUEUE":return e?Object.keys(e).reduce((function(e,t){return i()({},e,o()({},t,i()({},e[t],{isEnqueued:!1})))}),e):e;case"RECEIVE_DELETED_DOCUMENT":var n=t.response.data,r=n[0],c=r._id,a=r._type;return"io.cozy.triggers"===a?d()(e,c):e;default:return e}},b=function(e){return{type:"ENQUEUE_CONNECTION",trigger:e}},k=function(){return{type:"PURGE_QUEUE"}},_=function(e){return{type:"START_CONNECTION_CREATION",konnector:e}},w=function(){return{type:"END_CONNECTION_CREATION"}},C=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=!r.length||r.includes(t),c=e.konnectors[t]&&Object.keys(e.konnectors[t].triggers).length;return o&&c?Object.values(e.konnectors[t].triggers).filter((function(e){return n.includes(e.account)})):[]},O=function(e,t){var n=!!e.konnectors&&!!e.konnectors[t]&&!!e.konnectors[t].triggers&&Object.values(e.konnectors[t].triggers).find((function(e){return!!e.error}));return n?n.error:null},T=function(e,t){var n=!!e.konnectors&&!!e.konnectors[t]&&!!e.konnectors[t].triggers&&Object.values(e.konnectors[t].triggers).find((function(e){return Object(h.c)(e.error)}));return n?n.error:null},N=function(e,t){var n=!!e.konnectors&&!!e.konnectors[t]&&!!e.konnectors[t].triggers&&Object.values(e.konnectors[t].triggers).map((function(e){return e.lastSyncDate})).sort((function(e,t){var n=u.a.utc(e),r=u.a.utc(t);return n.isAfter(r)?-1:n.isBefore(r)?1:0}));return n.length&&n[0]},x=function(e,t){return e.konnectors?Object.keys(e.konnectors).reduce((function(n,r){var o=e.konnectors[r].triggers;if(!o)return n;var c=t[r];return n.concat(Object.keys(o).reduce((function(e,t){if(o[t].isEnqueued){var n=c.name,r=(i=o[t]).isRunning?"ongoing":i.hasError?"error":i.isConnected?"done":"pending";return e.concat({konnector:c,label:n,status:r,triggerId:t})}var i;return e}),[]))}),[]):[]},D=function(e,t){return R(e,t).error},S=function(e){return!!e.creation&&e.creation.account},z=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return!!t&&!!n&&r.includes(n._id)&&!!e.konnectors[t.slug]&&Object.keys(e.konnectors[t.slug].triggers).find((function(r){return e.konnectors[t.slug].triggers[r].account===n._id}))},R=function(e,t){var n=y(t);if(!n||!e.konnectors||!e.konnectors[n])return!1;var r=e.konnectors[n].triggers;return!!r&&(!!r&&!!r[t._id]&&r[t._id]||{})},I=function(e){return!!e.creation},A=function(e,t){return R(e,t).isConnected},L=function(e,t){return R(e,t).isEnqueued},j=function(e,t){return R(e,t).isRunning}},"7dT6":function(e){e.exports={app:{logo:{alt:"%{name} logo"}},date:{format:"MM/DD/YYYY",placeholder:"mm/dd/yyyy"},manifest:{name:"Home",short_description:"Cozy Collect is the application that help you gather all your personal data inside Cozy.",long_description:"With Cozy Collect, you can easily:\n * Downloads documents from all your suppliers\n * Set how often Cozy will collect your bills\n * Access directly to the documents gathered by your Cozy",changes:"You haven't missed it, the Store arrived in your Cozy!\nWe took advantage of it to improve Collect:\n * Store adaptation.\n * Tile merge: when you have several accounts for a single supplier, the former are now merged under the supplier tile.\n * Improvement of some Connectors pages."},add_service:"Add",fix_konnector_error:"Fix now",logout:"Log out",help:"Help",help_link:"https://help.cozy.io/",home_config_magic_folder:"/Settings/Home",account:{config:{default_folder:"/Administrative/%{name}",optional:"(Optional)",title:"Connect your %{name} account",data:{title:"Collected data:",service:{description:"Service description:"}},tabs:{sync:"synchronization",account:"account",data:"collected data"}},disconnect:{title:"Disconnection",description:"Your will be disconnected from this account, but imported data will be kept"},form:{title:"Account",label:{firstname:"Firstname",lastname:"Lastname",login:"Login",consumerKey:"Consumer Key",consumerSecret:"Consumer Secret",appKey:"Application Key",appSecret:"Application Secret",tricountUrl:"Tricount URL",cardNumber:"Card Number",dob:"Date of birth",password:"Password",email:"Email",bank_identifier:"Bank identifier (optional)",profileName:"Profile Name",identifier:"Identifier",new_identifier:"Identifier",secret:"Password",answer:"Secret Answer",access_token:"Access token",accessTokenSecret:"Access token secret",apikey:"Api key",phoneNumber:"Phone number",folderPath:"Folder path",namePath:"Folder name",authCode:"Auth code",accountName:"Account name",loginUrl:"Login URL",token:"Token",agreement:"I agree",refreshToken:"Refresh Token",timeout:"Delay (ms)",branchName:"Branch",code:"Confidential code"},placeholder:{password:"The password you use to connect to the service",update_password:"Update the password",accountName:"Example: Personal account",namePath:"Example: Camille bills. Default name path is your login."},button:{connect:"Connect",cancel:"Cancel",save:"Save",disconnect:"Disconnect this account",delete:"Delete this account",advanced:"Advanced options",synchronize:"Synchronize now"}},folder:{title:"Related folder settings",withoutSettings:{title:"Related folder"},link:"Open the folder in Cozy Drive",changePath:"change the path",error:"Oops, something went wrong. Don't panic, your files are still there, please try again later",close:"close",warning:"You're changing your folder path",oldFiles:"All your olds bills will be moved in your new path.",newFiles:"Your news bills will be downloaded in your new path.",newPath:"Everything went well, the new path for your %{name} account is:",placeholder:{administrative:"Administrative",photos:"Photos"}},success:{title:{connect:"Successful configuration!",update:"Your %{name} account is updated!"},banksLinkText:"See my accounts in %{appName}",driveLinkText:"Open the folder in Cozy Drive",button:"Close"},message:{folder:{title:"Folder",link:"Open folder on cozy drive"},success:{connect:"Your data will be available in your Cozy in a few minutes and the next ones will follow automatically.",update:"Your %{name} account has been updated successfully.",delete:"Account removed succesfully."},syncing:{bill:"Your bills are syncing and will be available in the following path:"},synced:{title:"Your data synchronization",cron:"Synchronization frequency: %{frequency}",cron_hourly:"each hour",cron_daily:"once a day",cron_weekly:"once a week",cron_monthly:"once a month",cron_undefined:"manually",syncing:"running…",unknown:"unknown",last_sync:"Last synchronization: **%{date}**",date_format:"MMMM D[,] YYYY [at] HH[:]mm",bill:"Find your datas in the Drive app at this location:"},error:{server:"Apologies, our server had an hiccup, do you mind starting again?",bad_credentials:"Sorry, you entered an incorrect login or password.",delete:"Apologies, our server had an hiccup, do you mind starting again?"}},forceConnection:"Run again now",editor_detail:"Service developed by %{editor}"},account_picker:{add_account_button:{label:"Add an account"}},apps:{title:"My apps"},connection:{CTA:{twofa_failed:"Run again now"},error:{default:{title:"An error occured",description:"Unfortunately, something went wrong when trying to connect to %{name}. Please check again your account informations, visit our online help or contact us at contact@cozycloud.cc."},DISK_QUOTA_EXCEEDED:{title:"Cozy Storage full",description:"This service cannot fetch your documents now. Please remove some files or go to **Settings > Storage** to get more free space."},CHALLENGE_ASKED:{title:"Challenge required",description:"It seems that the website requires a second authentification factor that we don’t support yet. You may try to settle the issue on the [%{name}](%{link}) website before a retry."},LOGIN_FAILED:{title:"Bad credentials",description:"Bad credentials. Check the konnector fields and run the connection again."},"LOGIN_FAILED.NEEDS_SECRET":{title:"Needs secret",description:"An additional field must be filled in before checking your credentials."},"LOGIN_FAILED.TOO_MANY_ATTEMPTS":{title:"Temporarily blocked",description:"Too many attempts occured. Please update your credentials on [%{name}](%{link}) website and update the konnector later on."},MAINTENANCE:{title:"Unavailable website",description:"It seems that the [%{name}](%{link}) website is unavailable or the konnector must be updated. Please rerun the connector later or visit our online help."},NOT_EXISTING_DIRECTORY:{title:"Missing destination folder",description:"It seems that this account's destination folder has been deleted. Please restore it by disconnecting this account and then reconnect again."},UNKNOWN_ERROR:{title:"Connection error",description:"An unknown error has occurred."},USER_ACTION_NEEDED:{title:"Action needed on the provider",description:"It seems that the [%{name}](%{link}) website requires you to log in and to do a specific action. Please rerun the connector once you have settled the issue on the website."},"USER_ACTION_NEEDED.OAUTH_OUTDATED":{title:"Access refresh required",description:"The [%{name}](%{link}) service requires you to allow your access again. Please disconnect and reconnect your account %{name} to this application. No data will be lost."},"USER_ACTION_NEEDED.ACCOUNT_REMOVED":{title:"Unavailable account",description:"It seems that your account is no longer active. Please check your account on [%{name}](%{link}) before retry."},"USER_ACTION_NEEDED.CHANGE_PASSWORD":{title:"Password update required",description:"It seems that the [%{name}](%{link}) website requires you to log in and update your password. Please rerun the connector once you have settled the issue on the website."},"USER_ACTION_NEEDED.PERMISSIONS_CHANGED":{title:"New permissions validation needed",description:"You connector was updated and the permissions changed. Please validate them before launching the connector again."},"USER_ACTION_NEEDED.TWOFA_EXPIRED":{title:"Relaunch the connexion to the service to fetch your data",description:"The last connexion to the service failed; please launch it again. You may have to provide a validation code."},"USER_ACTION_NEEDED.WRONG_TWOFA_CODE":{title:"Wrong two-factore code provided",description:"The two-factor code provided is wrong, please start again."},VENDOR_DOWN:{title:"Unavailable service",description:"It seems that the [%{name}](%{link}) service is unavailable at the moment. Please rerun the connector later."},"VENDOR_DOWN.BANK_DOWN":{title:"Unavailable website",description:"It seems that the [%{name}](%{link}) website is unavailable at the moment. Please rerun the connector later."},"VENDOR_DOWN.LINXO_DOWN":{title:"Unavailable service",description:"It seems that we are experiencing overload with our bank konnectors at the moment. Please rerun the connector later."}}},intent:{konnector:{install:{error:{message:"The konnector cannot be installed"}}},service:{return:"Back to connectors list",success:{button:{label:"Close"}},error:{initialization:"Service failed to initialize. Sorry for the inconvenience.",creation:"Unable to create account, an error occurred.",cause:"Cause: %{error}"},cancel:"Cancel",terminate:"Terminate"}},field:{password:{visibility:{hide:"Hide",show:"Show",title:{hide:"Hide password",show:"Show password"}}}},nav:{services:"My services"},category:{all:"All",banking:"Banks",health:"Health",insurance:"Insurance",transport:"Transportation",social:"Social",isp:"ISP",telecom:"Telecom",energy:"Energy",host_provider:"Host",productivity:"Productivity",shopping:"Shopping",public_service:"Public Services",other:"Others"},loading:{initial:"Loading accounts...",working:"Loading"},validation:{exact_length:"It's must be made up of %{length} characters exactly.",max_length:"The length maximum is %{length} characters.",min_length:"It should contain at least %{length} characters.",pattern:"The value must match a specific pattern: %{pattern}"},update:{title:"An update is available for this service.",regular:"Perform this update to keep fetching your data and to have the latest features",blocking:"Update it to keep fetching your data",CTA:"Update"},error:{initial:"Something went wrong when fetching your connectors and informations. Please refresh the page.",LOGIN_FAILED:"Bad credentials. Check the konnector fields and run the connection again.",UNKNOWN_ERROR:"Something unexpected happened while running the connector",JOB_TIMEOUT:"The connector execution was too long",button:{reload:"Refresh now"}},tutorial:{cozy_collect:{title:"Automate your data gathering",text:"They will be stored in your Cozy, you won't have to look for them anymore.",button:"Next"},home:{apps:{button:"Next",text:"Easily manage your digital life (files, pictures, bank accounts, ...)",title:"Access to all your Cozy applications"},services:{button:"Let's configure my accounts",text:"They will be stored in your Cozy, you won't have to look for them anymore.",title:"Automate your data gathering"}},menu_apps:{title:"Your Cozy is so much more than a simple data aggregator",text:"Open the Applications menu to discover all the features your Cozy has to offer.",button:"Discover my Apps"}},maintenance:{icon:"This connector is under maintenance",service:"Service interrupted",problem:"%{konnectorName} doesn't allow your Cozy to access your data",title:"What is going on ?"},connector:{debug:{successMessage:"This konnector is for debug purpose only, this is an additionnal custom success message."},empty:{title:"Start gathering your data!",text:"Synchronise your brands with your Cozy to automatically retrieve your data (bills, reimbursements, expenses…)"},silenced:'%{name} won\'t be suggested anymore. You can always find a provider by clicking the "Add" button.',noAccount:"No account",add:"Add a service",update:"Update available",logo:{alt:"%{name} logo"},enedis:{description:{service:"Recover your Linky data by connecting your Enedis account. You must have a Linky meter and have first created your Enedis account (on the [Enedis website](https://espace-client-connexion.enedis.fr/auth/UI/Login?realm=particuliers). This connector is provided by Fing for the MesInfos project. It retrieves the data from your electricity contract and downloads your electricity consumption the day before. This connector is running on your Cozy and the Fing will have no access to this data."}},orange:{message:{delay:"Once connected, a demand to extract your data will be sent to Orange information system. These data will be available within 15 days. You data will be updated automatically, every 15 days."}},orangemobile:{description:{connector:"In the context of 'MesInfos', Orange allows you to localize your phone regularly.\n\n**Data collection needs your express agreement**\n\nThis agreement may be revoked at any time by this data connector.\n\nBy clicking on \"Agree\", you give your consent to collect your phone's position, every 30 minutes. Information gathered will on be : \n<ul><li>Date and time of this location.</li><li>Location data of the closest radio antenna at the time of collect.</li></ul>Collected data by Orange after you agreement will be available only in your Cozy that you have been assigned in context of  « Mes Infos ». They will be added to location data already stored in call logs.",service:'This connector will download data from your Orange account on your Cozy. It will automatically download the call logs from your phone. Thus call logs include your phone number, your corresponding\'s phone number, date and time of this call and location data of the closest radio antenna at the time of collect.\n\nYou will be able to use these data in different apps in your Cozy, for example "Mapping My Life" (available soon on the Cozy Store).',field:{agreement:"Do you agree that Orange localizes regularly your phone in context of  « Mes Infos » ?"}}},orangevideos:{description:{service:'This connector will download data from your Orange account on your Cozy. It will automatically download the list of movies you downloaded in free (TV Replay) or paid VOD from 01/01/2015 (adult contents are not included).\n\nYou will be able to use these data in different apps in your Cozy, for example "My Movies Music" (available soon on the Cozy Store).'}},axabanque102:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},banquepopulaire:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},barclays136:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},bforbank97:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},bnpparibas82:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},boursorama83:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},bred:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},caatlantica3:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},caissedepargne1:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},carrefour159:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},casden173:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},cdngroup109:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},cdngroup88:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},cic45:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},cic63:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},comptenickel168:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},creditcooperatif148:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},creditmaritime:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},fortuneo84:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},hellobank145:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},hsbc119:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo).",connector:"The secret answer is [asked by HSBC](https://www.hsbc.fr/1/2/hsbc-france/particuliers/connexion) when you connect without double authentication. Example: what is the name of your pet?"}},ingdirect95:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},labanquepostale44:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},lcl143:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},lcl144:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},lcl146:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},monabanq96:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}},societegenerale:{description:{service:"The connection to your bank is operated and secured by our partner : Linxo. [Learn more](https://support.cozy.io/article/147-linxo)."}}},Queue:{header:"Syncing accounts:",header_mobile:"%{done} of %{total}",header_done:"Synced %{done} out of %{total}",item:{pending:"Pending"},close:"Close"},services:{title:"My services"},status:{interrupted:"INTERRUPTED SERVICE",edf:{maintenance:"EDF's information system has changed and the related data access doesn't work anymore. This konnector is not currently able to get back your data from EDF. We are trying to restore the situation and we will notice you when it will be fixed. [Learn more](%{supportLink})",support_link:"https://support.cozy.io/article/123-le-connecteur-edf-ne-fonctionne-pas"}},tile:{konnector:{lastSyncDate:{format:"MMM DD"}}}}},"8CvS":function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r={CHALLENGE_ASKED:"CHALLENGE_ASKED",LOGIN_FAILED:"LOGIN_FAILED",MAINTENANCE:"MAINTENANCE",NOT_EXISTING_DIRECTORY:"NOT_EXISTING_DIRECTORY",USER_ACTION_NEEDED:"USER_ACTION_NEEDED",VENDOR_DOWN:"VENDOR_DOWN",DISK_QUOTA_EXCEEDED:"DISK_QUOTA_EXCEEDED"},o={TERMS_VERSION_MISMATCH:"TERMS_VERSION_MISMATCH"};function c(e){return e&&e.type&&[r.CHALLENGE_ASKED,r.DISK_QUOTA_EXCEEDED,r.LOGIN_FAILED,r.NOT_EXISTING_DIRECTORY,r.USER_ACTION_NEEDED].includes(e.type)}function i(e){return e&&e.type&&Object.keys(o).includes(e.type)}function a(e){var t=new Error(e);return t.type=e.split(".")[0],t.code=e,t}},"8EAv":function(e,t,n){e.exports={"CozyTheme--normal":"CozyTheme--normal--2LDEk",spin:"spin--1tM1P",shake:"shake--2XjZi"}},"91CF":function(e,t,n){e.exports={"CozyTheme--normal":"CozyTheme--normal--269UB","maintenance-intro":"maintenance-intro--1-SbJ","maintenance-service":"maintenance-service--1ZZfz","maintenance-icon":"maintenance-icon--2QHy-"}},"B/vO":function(e,t,n){"use strict";var r=n("pVnL"),o=n.n(r),c=n("QILm"),i=n.n(c),a=n("q1tI"),s=n.n(a),u=n("rvOC"),l=n("SH7X");t.a=Object(l.withClient)((function(e){var t=e.client,n=i()(e,["client"]),r=new URL(t.getStackClient().uri),c=r.host,a="https:"===r.protocol;return s.a.createElement(u.a,o()({domain:c,secure:a},n))}))},K4zY:function(e,t,n){e.exports={"CozyTheme--normal":"CozyTheme--normal--1m1va","col-account-connection-content":"col-account-connection-content--Jta1z","col-account-connection-fetching":"col-account-connection-fetching--3rtXV","col-account-connection-security":"col-account-connection-security--1I2Yb","col-account-connection-editor":"col-account-connection-editor--1sA6J"}},KAKi:function(e,t,n){var r={"./en":"7dT6","./en.json":"7dT6"};function o(e){var t=c(e);return n(t)}function c(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=c,e.exports=o,o.id="KAKi"},N0Cd:function(e,t,n){e.exports={"col-account-description-title":"col-account-description-title--vVTHU","col-account-description-title-centered":"col-account-description-title-centered--32S1O","col-account-description-message":"col-account-description-message--ZyZtK"}},ONtV:function(e,t,n){e.exports={"CozyTheme--normal":"CozyTheme--normal--1iUvc","col-trigger-folder":"col-trigger-folder--3s1fX","col-trigger-folder-link":"col-trigger-folder-link--2Fkdb"}},QxZi:function(e){e.exports=["energy","insurance","isp","shopping","telecom","transport","banking","public_service"]},cXEB:function(e,t,n){"use strict";var r=n("fvjX"),o=n("m+TH"),c=n("1mXj"),i=n("lSNA"),a=n.n(i),s=n("QCzH"),u=function(e){return function(){return function(t){return function(n){var r=n.response;switch(n.type){case"RECEIVE_DATA":case"RECEIVE_NEW_DOCUMENT":if(r&&"io.cozy.konnectors"===n.doctype){var o=r.data;o&&o.length&&o.forEach(function(e){return function(t){var n=t.langs,r=t.locales,o=n&&n.length;if(!o)return console.warn("Konnector ".concat(t.name," does not specify any lang")),t;var c=o&&n.includes(e)?e:n[0],i=r&&Object.keys(r);return i&&i.length&&i.includes(c)?(Object(s.a)(a()({},t.slug,r[c])),t):(console.warn("Konnector ".concat(t.name," does not specify any locale for lang ").concat(c)),t)}}(e))}}return t(n)}}}},l=n("sINF"),d=n("o0o1"),p=n.n(d),f=n("yXPU"),h=n.n(f),y=n("lwsE"),m=n.n(y),g=n("W8MJ"),v=n.n(g),E=n("MVZn"),b=n.n(E);function k(e,t){return _.apply(this,arguments)}function _(){return(_=h()(p.a.mark((function e(t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.fetchJSON("GET","/jobs/triggers/".concat(n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=n("oBqo"),C=n.n(w),O=function(e,t){return b()({},e,e.attributes,{id:e._id,_type:t||e._type})},T=function(){function e(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};m()(this,e),this.client=r,this.listener=null,this.options=o,this.categories=n("QxZi"),this.updateUnfinishedJob=this.updateUnfinishedJob.bind(this),this.onAccountCreated=this.onAccountCreated.bind(this),this.onAccountUpdated=this.onAccountUpdated.bind(this),this.onAccountDeleted=this.onAccountDeleted.bind(this),this.onTriggerCreated=this.onTriggerCreated.bind(this),this.onTriggerDeleted=this.onTriggerDeleted.bind(this),this.initializeRealtime()}var t,r,o,c,i,a,s;return v()(e,[{key:"initializeRealtime",value:function(){this.realtime=new C.a({client:this.client}),this.realtime.subscribe("created","io.cozy.jobs",this.updateUnfinishedJob),this.realtime.subscribe("updated","io.cozy.jobs",this.updateUnfinishedJob),this.realtime.subscribe("created","io.cozy.accounts",this.onAccountCreated),this.realtime.subscribe("updated","io.cozy.accounts",this.onAccountUpdated),this.realtime.subscribe("deleted","io.cozy.accounts",this.onAccountDeleted),this.realtime.subscribe("created","io.cozy.triggers",this.onTriggerCreated),this.realtime.subscribe("deleted","io.cozy.triggers",this.onTriggerDeleted)}},{key:"onAccountCreated",value:(s=h()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.dispatch({type:"RECEIVE_NEW_DOCUMENT",response:{data:[O(t,"io.cozy.accounts")]},updateCollections:["accounts"]});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"onAccountUpdated",value:(a=h()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.dispatch({type:"RECEIVE_UPDATED_DOCUMENT",response:{data:[O(t,"io.cozy.accounts")]},updateCollections:["accounts"]});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"onAccountDeleted",value:(i=h()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.dispatch({type:"RECEIVE_DELETED_DOCUMENT",response:{data:[O(t,"io.cozy.accounts")]},updateCollections:["accounts"]});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onTriggerCreated",value:(c=h()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.dispatch({type:"RECEIVE_NEW_DOCUMENT",response:{data:[O(t,"io.cozy.triggers")]},updateCollections:["triggers"]});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"onTriggerUpdated",value:(o=h()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.dispatch({type:"RECEIVE_UPDATED_DOCUMENT",response:{data:[O(t,"io.cozy.triggers")]},updateCollections:["triggers"]});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"onTriggerDeleted",value:(r=h()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.dispatch({type:"RECEIVE_DELETED_DOCUMENT",response:{data:[O(t,"io.cozy.triggers")]},updateCollections:["triggers"]});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updateUnfinishedJob",value:(t=h()(p.a.mark((function e(t){var n,r,o,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=O(t,"io.cozy.jobs"),r="konnector"===n.worker,o=!!n.account_deleted,c=!n.trigger_id,r&&!o&&!c){e.next=6;break}return e.abrupt("return");case 6:return this.dispatch({type:"RECEIVE_NEW_DOCUMENT",response:{data:[n]},updateCollections:["jobs"]}),e.next=9,k(cozy.client,n.trigger_id);case 9:i=e.sent,this.onTriggerUpdated(i);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"createIntentService",value:function(e,t){return cozy.client.intents.createService(e,t)}},{key:"fetchUrls",value:function(){var e=this;return cozy.client.fetchJSON("GET","/apps/").then((function(t){t.forEach((function(t){if(t.attributes&&t.attributes.slug&&t.links)switch(t.attributes.slug){case"banks":e.banksUrl="".concat(t.links.related)}}))})).catch((function(e){return console.warn(e.message),!1}))}}]),e}(),N=n("kdbL"),x=n.n(N),D=n("cokx");t.a=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE||r.compose,s=Object(r.createStore)(Object(D.a)(),a(r.applyMiddleware.apply(void 0,[Object(o.e)(e),u(i.lang),l.default,x()("redux-logger")?Object(c.createLogger)():null].filter(Boolean))));return Object.assign(new T(n,t,i),s)}},cokx:function(e,t,n){"use strict";n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return y})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return v})),n.d(t,"b",(function(){return E}));var r=n("fvjX"),o=n("mwIZ"),c=n.n(o),i=n("m+TH"),a=n("/n/j"),s=n("3dAU"),u=n("uZd2"),l=n("rGvZ"),d=n("4YEU");t.a=function(){return Object(r.combineReducers)({apps:a.a,connections:d.a,cozy:i.j})};var p=function(e){return u.c(e.cozy)},f=function(e){return d.j(e.connections,u.b(e.cozy))},h=function(e){return s.b(e.cozy,d.f(e.connections))},y=function(e,t){return l.b(e.cozy,t,s.c(e.cozy)).length},m=function(e,t,n){var r=d.k(e.connections,t,n,s.c(e.cozy));return l.c(e.cozy,r)},g=function(e,t){var n=e.cozy.documents["io.cozy.triggers"]||{};return Object.keys(n).reduce((function(n,r){var o=e.cozy.documents["io.cozy.triggers"][r];return"konnector"===o.worker&&c()(o,"message.konnector")===t&&n.push(o),n}),[])},v=function(e){var t=c()(e,["cozy","documents","io.cozy.triggers"],{});return Object.values(t).filter((function(e){return"errored"===c()(e,"current_state.status")}))},E=function(e){var t=v(e).map((function(e){return c()(e,"message.account")})),n=c()(e,["cozy","documents","io.cozy.accounts"],{});return Object.values(n).filter((function(e){var n=e._id;return t.includes(n)}))}},"d/w2":function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),o=n.n(r),c=n("i8i4"),i=n("IN8/"),a=(n("/8/d"),n("M50D"),n("SH7X")),s=n.n(a),u=n("buk/"),l=n("cXEB"),d=n("m+TH"),p=n("Le8U"),f=n("lwsE"),h=n.n(f),y=n("W8MJ"),m=n.n(y),g=n("a1gu"),v=n.n(g),E=n("Nsbk"),b=n.n(E),k=n("7W2i"),_=n.n(k),w=n("17x9"),C=n.n(w),O=n("le8I"),T=n("V2U0"),N=n("mD6Q"),x=n("o0o1"),D=n.n(x),S=n("yXPU"),z=n.n(S),R=n("/MKj"),I=n("PJYZ"),A=n.n(I),L=n("lSNA"),j=n.n(L),U=n("pVnL"),M=n.n(U),F=n("wIs1"),P=n("iDCe"),V=n("TSYQ"),Y=n.n(V),q=n("OFL0"),H=n.n(q),G=n("xweI"),B=n.n(G),K=n("KXWi"),W=n("4P+e"),J=n.n(W),Z=n("4DAK"),X=n("N0Cd"),Q=n.n(X),$=function(e){var t=e.cssClassesObject,n=e.title,r=e.messages,c=e.children,i=e.hasError,a=e.centerTitle;return o.a.createElement("div",{className:Y()(t)},n&&o.a.createElement("h4",{className:a?Q.a["col-account-description-title-centered"]:Q.a["col-account-description-title"]},n),r&&r.length>0&&r.map((function(e,t){return e?o.a.createElement("div",{key:t,className:Y()(Q.a["col-account-description-message"],i&&"errors")},o.a.createElement(Z.a,{source:e})):null})),c)},ee=n("y6ex"),te=n("/n/j"),ne=n("ONtV"),re=n.n(ne),oe=function(e){function t(){return h()(this,t),v()(this,b()(t).apply(this,arguments))}return _()(t,e),m()(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.href;return n?o.a.createElement("a",{className:t,href:n,target:"_parent"},this.props.children):o.a.createElement("span",{className:t},this.props.children)}}]),t}(r.PureComponent),ce=function(e){function t(){return h()(this,t),v()(this,b()(t).apply(this,arguments))}var n;return _()(t,e),m()(t,[{key:"componentDidMount",value:(n=z()(D.a.mark((function e(){var t,n,r,o,c,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.client,r=t.driveApp,o=t.receiveApps,r){e.next=7;break}return e.next=4,n.query(Object(a.Q)("io.cozy.apps"));case 4:c=e.sent,i=c.data,o(i);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this.props,t=e.driveApp,n=e.label,r=e.folderId,c=!t;return o.a.createElement(oe,{className:Y()(re.a["col-trigger-folder-link"],{"u-silver":c,"u-c-not-allowed":c}),href:t&&"".concat(t.links.related,"#/files/").concat(r)},o.a.createElement(ee.a,{className:"u-mr-half",icon:"openwith"}),n)}}]),t}(r.PureComponent),ie=Object(R.connect)((function(e){return{driveApp:Object(te.b)(e.apps,"drive")}}),(function(e){return{receiveApps:function(t){return e(Object(te.c)(t))}}}))(Object(a.withClient)(ce)),ae=n("sCMN"),se=Object(u.d)()((function(e){var t=e.banksUrl,n=e.t;return t?o.a.createElement(ae.a,{slug:"banks",href:t},(function(e){var t=e.href,r=e.onClick,c=e.name;return o.a.createElement("a",{className:J.a["col-account-success-link"],href:t,target:"_top",onClick:r},o.a.createElement(ee.a,{className:"u-mr-half",icon:"openwith"}),n("account.success.banksLinkText",{appName:c}))})):o.a.createElement("a",{className:J.a["col-account-success-link"],onClick:function(){return cozy.client.intents.redirect("io.cozy.apps",{slug:"banks"},(function(e){window.top.location.href=e}))}},o.a.createElement(ee.a,{className:"u-mr-half",icon:"openwith"}),n("account.success.banksLinkText"))})),ue=n("vL8P"),le=n.n(ue),de=function(){return o.a.createElement("div",{className:J.a["col-account-success-illu-wrapper"]},o.a.createElement("img",{src:le.a,className:J.a["col-account-success-illu"]}))},pe=function(e){var t=e.children;return o.a.createElement("p",{className:Y()(J.a["col-account-success-links"],"u-mv-half")},t)},fe=Object(u.d)()((function(e){var t=e.folderId,n=e.t;return o.a.createElement(ie,{folderId:t,label:n("account.success.driveLinkText")})})),he=Object(u.d)()((function(e){var t=e.children;return o.a.createElement("div",{className:J.a["coz-form-controls-success"]},o.a.createElement("div",{className:J.a["col-account-form-success-buttons"]},t))})),ye=function(e){function t(){return h()(this,t),v()(this,b()(t).apply(this,arguments))}return _()(t,e),m()(t,[{key:"componentDidMount",value:function(){"function"==typeof this.props.handleConnectionSuccess&&this.props.handleConnectionSuccess()}},{key:"render",value:function(){var e=this,n=this.props,r=n.account,c=n.error,i=n.title,a=n.messages,s=B()(Object.values(t.apps).filter((function(t){return t.predicate(e.props)})),(function(e){return-e.priority})),u=s.length>0;return r&&o.a.createElement("div",{className:J.a["col-account-success"]},!c&&o.a.createElement(de,null),o.a.createElement($,{title:!c&&i,messages:!c&&a},u&&o.a.createElement(pe,null,s.map((function(t,n){return t.successLink(e.props,e.context,n)})))),o.a.createElement(he,null,s.length>0?s[0].footerLink(this.props,this.context):null))}}]),t}(r.Component);ye.apps={drive:{priority:1,predicate:function(e){var t=e.trigger;return H()(t,"message.folder_to_save")},successLink:function(e,t,n){return o.a.createElement(fe,{key:n,folderId:e.trigger.message.folder_to_save})},footerLink:function(e){var t=e.t,n=e.onDone,r=e.account,c=e.successButtonLabel;return o.a.createElement(K.c,{label:c||t("account.success.button"),onClick:function(e){e.preventDefault(),n(r)}})}},banks:{priority:0,predicate:function(e){var t=e.connector;return Array.isArray(t.data_types)&&t.data_types.includes("bankAccounts")},successLink:function(e,t,n){return o.a.createElement(se,{key:n,banksUrl:t.store.banksUrl})},footerLink:function(){return null}}},ye.contextTypes={store:C.a.object},ye.propTypes={account:C.a.object.isRequired,error:C.a.string,title:C.a.string.isRequired,messages:C.a.arrayOf(C.a.string),onDone:C.a.func.isRequired,successButtonLabel:C.a.string,trigger:C.a.object.isRequired};var me=Object(u.d)()(ye),ge=n("uZd2"),ve=n("K4zY"),Ee=n.n(ve),be=function(e){function t(e){var n;return h()(this,t),(n=v()(this,b()(t).call(this,e))).state={trigger:null,success:!1},n.handleLoginSuccess=n.handleLoginSuccess.bind(A()(n)),n.handleSuccess=n.handleSuccess.bind(A()(n)),n}return _()(t,e),m()(t,[{key:"handleLoginSuccess",value:function(e){this.setState({trigger:e,success:!0}),this.props.onLoginSuccess(e)}},{key:"handleSuccess",value:function(e){this.setState({trigger:e,success:!0}),this.props.onSuccess(e)}},{key:"render",value:function(){var e=this.props,t=e.account,n=e.konnector,r=e.legacySuccess,c=e.onDone,i=e.successMessage,a=e.successMessages,s=e.successButtonLabel,u=e.t,l=this.state,d=l.trigger;return l.success||r?o.a.createElement(me,{account:t,connector:n,folderId:d&&d.message.folder_to_save,onDone:c,title:i,trigger:d,messages:a,successButtonLabel:s}):o.a.createElement("div",{className:Ee.a["col-account-connection-content"]},o.a.createElement("div",{className:Ee.a["col-account-connection-form"]},o.a.createElement("h4",{className:"u-ta-center"},u("account.config.title",{name:n.name})),o.a.createElement(P.c,{account:t,konnector:n,onLoginSuccess:this.handleLoginSuccess,onSuccess:this.handleSuccess,vaultClosable:!1})))}}]),t}(r.Component),ke=Object(u.d)()(Object(R.connect)((function(e,t){return{konnector:Object(ge.d)(e.cozy,t.connector.slug)}}))(be)),_e=n("91CF"),we=n.n(_e),Ce=Object(u.d)()((function(e){var t=e.t,n=e.maintenance,r=e.lang,c=e.konnectorName;return o.a.createElement("div",{className:we.a.maintenance},o.a.createElement("div",{className:we.a["maintenance-intro"]},o.a.createElement("div",{className:we.a["maintenance-icon"]}),o.a.createElement("h3",{className:we.a["maintenance-service"]},t("maintenance.service")),o.a.createElement("p",{className:we.a["maintenance-problem"]},t("maintenance.problem",{konnectorName:c}))),o.a.createElement("h4",{className:we.a["maintenance-title"]},t("maintenance.title")),o.a.createElement(Z.a,{className:we.a["maintenance-message"],source:n.message[r]||n.message.en}))})),Oe=n("M2p0"),Te=function(e){function t(e){var n;return h()(this,t),(n=v()(this,b()(t).call(this,e))).state={isRedirecting:!1},n.redirectToStore=n.redirectToStore.bind(A()(n)),n}var n;return _()(t,e),m()(t,[{key:"redirectToStore",value:(n=z()(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isRedirecting:!0}),t=this.props.konnector,e.prev=2,e.next=5,cozy.client.intents.redirect("io.cozy.apps",{slug:t.slug,step:"update"});case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0),this.setState({isRedirecting:!1});case 11:case"end":return e.stop()}}),e,this,[[2,7]])}))),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this.props,t=e.t,n=e.isBlocking,r=this.state.isRedirecting;return o.a.createElement(Oe.a,{actionButton:o.a.createElement(K.c,{label:t("update.CTA"),theme:"danger",className:"u-m-0",onClick:this.redirectToStore,disabled:r}),className:"u-maw-none",text:t(n?"update.blocking":"update.regular"),isImportant:n,title:t("update.title")})}}]),t}(r.Component);Te.propTypes={konnector:C.a.object.isRequired,isBlocking:C.a.bool,t:C.a.func.isRequired};var Ne=Object(u.d)()(Te),xe=n("4YEU"),De=n("8CvS"),Se=n("gwpp"),ze=n.n(Se),Re=function(e){function t(e,n){var r;return h()(this,t),(r=v()(this,b()(t).call(this,e,n))).store=n.store,r.state={isFetching:!1,maintenance:e.maintenance&&e.maintenance[e.konnector.slug]},r.handleLoginSuccess=r.handleLoginSuccess.bind(A()(r)),r.handleError=r.handleError.bind(A()(r)),r.handleDeleteSuccess=r.handleDeleteSuccess.bind(A()(r)),r}return _()(t,e),m()(t,[{key:"componentDidMount",value:function(){this.props.error&&this.handleError({message:this.props.error})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.success,r=t.queued,o=this.state.connectionError,c=!e.success&&n,i=!e.queued&&r;(c||i)&&(c&&o&&this.setState({connectionError:null}),this.props.handleConnectionSuccess())}},{key:"handleLoginSuccess",value:function(e){var t=this.props,n=t.enqueueConnection;(0,t.handleConnectionSuccess)(),n(e)}},{key:"handleDeleteSuccess",value:function(){this.setState({submitting:!1}),this.props.handleDeleteSuccess()}},{key:"handleError",value:function(e){console.error(e),this.setState({submitting:!1,connectionError:e.message})}},{key:"buildSuccessMessages",value:function(e){var t=this.props.t,n=[t("account.message.success.connect",{name:e.name})];return e.additionnalSuccessMessage&&e.additionnalSuccessMessage.message&&n.push(t(e.additionnalSuccessMessage.message)),n}},{key:"render",value:function(){var e=this.props,t=e.createdAccount,n=e.handleConnectionSuccess,r=e.konnector,c=e.error,i=e.onCancel,a=e.onDone,s=e.queued,u=e.t,l=e.lang,d=e.success,p=e.successButtonLabel,f=this.state,h=f.connectionError,y=f.oAuthError,m=f.maintenance,g=d||s?this.buildSuccessMessages(r):[],v=c||y||h;return o.a.createElement("div",{className:ze.a["col-account-connection"]},!!r.available_version&&o.a.createElement(Ne,{konnector:r,error:v,isBlocking:Object(De.b)(v)}),m?o.a.createElement(Ce,{maintenance:m,lang:l,konnectorName:r.name}):o.a.createElement(ke,{account:t,connector:r,onCancel:i,onDone:a,onLoginSuccess:this.handleLoginSuccess,onSuccess:n,legacySuccess:d||s,successMessage:u("account.success.title.connect"),successButtonLabel:p,successMessages:g}))}}]),t}(r.Component);Re.contextTypes={store:C.a.object};var Ie=Object(R.connect)((function(e,t){return{success:Object(xe.l)(e.connections,t.trigger),error:Object(xe.d)(e.connections,t.trigger),queued:Object(xe.m)(e.connections,t.trigger)}}),(function(e){return{enqueueConnection:function(t){return e(Object(xe.c)(t))}}}))(Object(F.a)(Object(u.d)()(Re))),Ae=n("cokx"),Le=function(e){function t(e,n){var r;return h()(this,t),r=v()(this,b()(t).call(this,e,n)),j()(A()(r),"onSuccess",(function(e){r.props.endCreation(),r.props.onSuccess(e)})),r.props.startCreation(r.props.konnector),r}return _()(t,e),m()(t,[{key:"render",value:function(){var e=this.props.t;return o.a.createElement("div",{className:"coz-service-content"},o.a.createElement(Ie,M()({onDone:this.onSuccess,successButtonLabel:e("intent.service.success.button.label")},this.props)))}}]),t}(o.a.Component),je=Object(R.connect)((function(e,t){var n=t.konnector,r=Object(Ae.d)(e),o=Object(Ae.g)(e,n,r);return{createdAccount:r,isCreating:Object(xe.o)(e.connections),isRunning:Object(xe.n)(e.connections,o),trigger:o}}),(function(e,t){return{startCreation:function(){return e(Object(xe.q)(t.konnector))},endCreation:function(){return e(Object(xe.b)())}}}))(Object(u.d)()(Le)),Ue=n("B/vO"),Me=n("gpME"),Fe=n.n(Me),Pe=function(e){function t(){return h()(this,t),v()(this,b()(t).apply(this,arguments))}return _()(t,e),m()(t,[{key:"render",value:function(){var e=this.props,t=e.center,n=e.konnector,r=e.t;return o.a.createElement("div",{className:Fe.a["col-konnector-header-icon-wrapper".concat(t?"--center":"")]},o.a.createElement(Ue.a,{alt:r("app.logo.alt",{name:n.name}),app:n,className:Fe.a["col-konnector-header-icon".concat(t?"--center":"")]}))}}]),t}(r.Component);Pe.propTypes={center:C.a.bool,konnector:C.a.object.isRequired,t:C.a.func.isRequired};var Ve=Object(u.d)()(Pe),Ye=function(e){function t(e,n){var r;return h()(this,t),r=v()(this,b()(t).call(this,e,n)),j()(A()(r),"handleConnectionSuccess",(function(){r.setState({isSuccess:!0})})),r.store=n.store,r.state={isSuccess:!1},r.store.fetchUrls(),r}return _()(t,e),m()(t,[{key:"render",value:function(){var e=this.props,t=e.konnector,n=e.onCancel,r=e.onTerminate,c=this.state.isSuccess;return o.a.createElement("div",{className:"col-create-account-intent"},!c&&o.a.createElement(Ve,{konnector:t,center:!0}),t&&o.a.createElement(je,{konnector:t,onCancel:function(){return n()},onSuccess:r,handleConnectionSuccess:this.handleConnectionSuccess}))}}]),t}(r.Component);Ye.contextTypes={store:C.a.object};var qe=Ye,He=function(e){function t(e){var n;return h()(this,t),(n=v()(this,b()(t).call(this,e))).state={error:null},n}var n;return _()(t,e),m()(t,[{key:"handleInstallationSuccess",value:function(e){this.props.receiveKonnector(e)}},{key:"componentDidMount",value:(n=z()(D.a.mark((function e(){var t,n,r,o,c,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.data,r=t.konnector,o=t.receiveKonnector,!(c=t.service)||r){e.next=8;break}return e.next=4,c.compose("INSTALL","io.cozy.apps",n);case 4:if(i=e.sent){e.next=7;break}return e.abrupt("return",c.cancel());case 7:o(i);case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onError",value:function(e){this.setState({error:e})}},{key:"render",value:function(){var e=this.props,t=e.appData,n=e.konnector,r=e.onCancel,c=e.service,i=e.t,a=this.state.error;return o.a.createElement("div",{className:"coz-service"},a&&o.a.createElement("div",{className:"coz-error coz-service-error"},o.a.createElement("p",null,i(a.message)),a.reason&&o.a.createElement("p",null,i("intent.service.error.cause",{error:a.reason}))),!a&&n&&o.a.createElement(qe,{appData:t,konnector:n,onCancel:r,onTerminate:c.terminate}))}}]),t}(r.Component),Ge=Object(R.connect)((function(e,t){var n=t.data.slug;return{konnector:n&&Object(ge.d)(e.cozy,n)}}),(function(e){return{receiveKonnector:function(t){return e(Object(ge.f)(t))}}}))(Object(u.d)()(He)),Be=function(e){function t(e,n){var r;return h()(this,t),(r=v()(this,b()(t).call(this,e,n))).store=n.store,r.state={isInitializing:!0},r.store.createIntentService().then((function(e){r.setState({isInitializing:!1,service:e})})).catch((function(e){r.setState({isInitializing:!1,error:{message:"intent.service.error.initialization",reason:e.message}})})),r}return _()(t,e),m()(t,[{key:"terminate",value:function(e){this.state.service.terminate(e)}},{key:"cancel",value:function(){this.state.service.cancel()}},{key:"handleError",value:function(e){throw this.setState({error:{message:"intent.service.error.creation",reason:e.message}}),e}},{key:"render",value:function(){var e=this,t=this.props,n=t.appData,r=t.accounts,c=t.konnectors,i=t.triggers,a=t.t,s=this.state,u=s.error,l=s.service,d=this.state.isInitializing;return d=d||[r,c,i].find((function(e){return["pending","loading"].includes(e.fetchStatus)})),o.a.createElement("div",{className:"coz-service"},d&&o.a.createElement("div",{className:"coz-service-loading"},o.a.createElement(T.a,{size:"xxlarge"})),u&&o.a.createElement("div",{className:"coz-error coz-service-error"},o.a.createElement("p",null,a(u.message)),o.a.createElement("p",null,a("intent.service.error.cause",{error:u.reason}))),!d&&!u&&o.a.createElement(Ge,{appData:n,data:l.getData(),onTerminate:function(t){return e.terminate(t)},onCancel:function(){return e.cancel()},service:l}),o.a.createElement(O.a,null))}}]),t}(r.Component);Be.contextTypes={store:C.a.object};var Ke=Object(N.a)(Object(u.d)()(Be)),We=(n("8EAv"),document.documentElement.getAttribute("lang")||"en"),Je=window.context||"cozy";document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector("[role=application]").dataset,t=new d.a({cozyURL:"//".concat(e.cozyDomain),token:e.cozyToken}),r=new s.a({uri:"".concat(window.location.protocol,"//").concat(e.cozyDomain),schema:{app:p.Application.schema,accounts:{doctype:"io.cozy.accounts",attributes:{},relationships:{master:{type:"has-one",doctype:"io.cozy.accounts"}}},permissions:{doctype:"io.cozy.permissions",attributes:{}},triggers:{doctype:"io.cozy.triggers"}},token:e.cozyToken}),f=Object(l.a)(t,r,Je,{lang:We});Object(c.render)(o.a.createElement(a.CozyProvider,{client:r},o.a.createElement(d.b,{domain:e.cozyDomain,store:f,client:r,secure:!0},o.a.createElement(u.b,{lang:We,dictRequire:function(e){return n("KAKi")("./".concat(e))},context:Je},o.a.createElement(i.a,null,o.a.createElement(Ke,{appData:e}))))),document.querySelector("[role=application]"))}))},gpME:function(e,t,n){e.exports={"col-konnector-header-icon-wrapper":"col-konnector-header-icon-wrapper--1oMyA","col-konnector-header-icon-wrapper--center":"col-konnector-header-icon-wrapper--center--3aLBw","col-konnector-header-icon":"col-konnector-header-icon--2Yxl_","col-konnector-header-icon--center":"col-konnector-header-icon--center--3rGkD"}},gwpp:function(e,t,n){e.exports={"col-account-connection":"col-account-connection--3AgeF"}},iUaz:function(e,t,n){var r={"./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc"};function o(e){var t=c(e);return n(t)}function c(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=c,e.exports=o,o.id="iUaz"},kGy0:function(e,t,n){var r={"./en.json":"8WAw","./fr.json":"H488"};function o(e){var t=c(e);return n(t)}function c(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=c,e.exports=o,o.id="kGy0"},"m+TH":function(e,t,n){"use strict";var r=n("lwsE"),o=n.n(r),c=n("W8MJ"),i=n.n(c),a=n("a1gu"),s=n.n(a),u=n("Nsbk"),l=n.n(u),d=n("7W2i"),p=n.n(d),f=n("lSNA"),h=n.n(f),y=n("q1tI"),m=n.n(y),g=n("17x9"),v=n.n(g),E=function(e){function t(){return o()(this,t),s()(this,l()(t).apply(this,arguments))}return p()(t,e),i()(t,[{key:"getChildContext",value:function(){return{domain:this.props.domain,secure:this.props.secure,store:this.props.store||this.context.store,client:this.props.client}}},{key:"render",value:function(){return this.props.children||null}}]),t}(y.Component);h()(E,"propTypes",{domain:v.a.string,secure:v.a.bool,store:v.a.shape({subscribe:v.a.func.isRequired,dispatch:v.a.func.isRequired,getState:v.a.func.isRequired}),client:v.a.object.isRequired,children:v.a.element.isRequired}),h()(E,"childContextTypes",{domain:v.a.string,secure:v.a.bool,store:v.a.object,client:v.a.object.isRequired}),h()(E,"contextTypes",{store:v.a.object});var b=n("RIqP"),k=n.n(b),_=n("o0o1"),w=n.n(_),C=n("yXPU"),O=n.n(C),T=n("MVZn"),N=n.n(T),x=n("QILm"),D=n.n(x),S=function(){function e(){o()(this,e)}var t,n,r,c,a,s,u,l,d,p,f,y,m,g,v,E,b,_,C;return i()(e,[{key:"fetchApps",value:(C=O()(w.a.mark((function e(){var t,n,r,o,c=arguments;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:0,e.next=3,cozy.client.fetchJSON("GET","/apps/",null,{processJSONAPI:!1});case 3:return n=e.sent,r=n.data,o=n.meta,e.abrupt("return",{data:r||[],meta:o,skip:t,next:!!o&&o.count>t+50});case 7:case"end":return e.stop()}}),e)}))),function(){return C.apply(this,arguments)})},{key:"fetchDocuments",value:(_=O()(w.a.mark((function e(t){var n,r,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,cozy.client.fetchJSON("GET","/data/".concat(t,"/_all_docs?include_docs=true"));case 3:return n=e.sent,r=n.rows.filter((function(e){return!e.doc.hasOwnProperty("views")})),o=r.map((function(e){return Object.assign({},e.doc,{id:e.id,_type:t})})),e.abrupt("return",{data:o,meta:{count:n.total_rows},skip:n.offset,next:!1});case 9:if(e.prev=9,e.t0=e.catch(0),!e.t0.message.match(/not_found/)){e.next=13;break}return e.abrupt("return",{data:[],meta:{count:0},skip:0,next:!1});case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,9]])}))),function(e){return _.apply(this,arguments)})},{key:"queryDocuments",value:(b=O()(w.a.mark((function e(t,n,r){var o,c,i,a,s,u,l,d,p;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.fields,c=r.skip||0,i=r.sort?n.fields.map((function(e){return h()({},e,r.sort[e]||"desc")})):void 0,a=N()({limit:50,wholeResponse:!0},r,{fields:[].concat(k()(o),["_id","_type","class"]),skip:c,sort:i}),"io.cozy.files"!==t){e.next=13;break}return e.next=7,cozy.client.files.query(n,a);case 7:d=e.sent,s=d.data.map((function(e){return Object.assign({_id:e.id,_type:t},e,e.attributes)})),u=d.meta,l=u.count>c+50,e.next=19;break;case 13:return e.next=15,cozy.client.data.query(n,a);case 15:p=e.sent,s=p.docs.map((function(e){return Object.assign({id:e._id,_type:t},e)})),u={},l=p.next;case 19:return e.abrupt("return",{data:s,meta:u,next:l});case 20:case"end":return e.stop()}}),e)}))),function(e,t,n){return b.apply(this,arguments)})},{key:"fetchDocument",value:(E=O()(w.a.mark((function e(t,n){var r,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cozy.client.data.find(t,n);case 2:return r=e.sent,o=N()({},r,{id:r._id,_type:r._type}),e.abrupt("return",{data:[o]});case 5:case"end":return e.stop()}}),e)}))),function(e,t){return E.apply(this,arguments)})},{key:"init",value:function(e){this.config=N()({},e)}},{key:"createDocument",value:(v=O()(w.a.mark((function e(t,n){var r,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cozy.client.data.create(t,n);case 2:return r=e.sent,o=N()({},r,{id:r._id,_type:t}),e.abrupt("return",{data:[o]});case 5:case"end":return e.stop()}}),e)}))),function(e,t){return v.apply(this,arguments)})},{key:"createTrigger",value:(g=O()(w.a.mark((function e(t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cozy.client.fetchJSON("POST","/jobs/triggers",{data:t});case 2:return n=e.sent,r=N()({},n,n.attributes,{id:n._id}),e.abrupt("return",{data:[r]});case 5:case"end":return e.stop()}}),e)}))),function(e){return g.apply(this,arguments)})},{key:"launchTrigger",value:(m=O()(w.a.mark((function e(t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cozy.client.fetchJSON("POST","/jobs/triggers/".concat(t._id,"/launch"));case 2:return n=e.sent,r=N()({},n,n.attributes,{id:n._id}),e.abrupt("return",{data:[r]});case 5:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)})},{key:"updateDocument",value:(y=O()(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cozy.client.data.updateAttributes(t._type,t.id,t);case 2:return n=e.sent,e.abrupt("return",{data:[N()({},t,{_rev:n._rev})]});case 4:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"deleteDocument",value:(f=O()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cozy.client.data.delete(t._type,t);case 2:return e.abrupt("return",{data:[t]});case 3:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"deleteTrigger",value:(p=O()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cozy.client.fetchJSON("DELETE","/jobs/triggers/".concat(t._id));case 2:return e.abrupt("return",{data:[t]});case 3:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"createIndex",value:function(e,t){return cozy.client.data.defineIndex(e,t)}},{key:"fetchFileByPath",value:(d=O()(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,cozy.client.files.statByPath(t);case 3:return n=e.sent,e.abrupt("return",{data:[z(n)]});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e){return d.apply(this,arguments)})},{key:"createFile",value:(l=O()(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cozy.client.files.create(t,{dirID:n});case 2:return r=e.sent,e.abrupt("return",{data:[z(r)]});case 4:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)})},{key:"trashFile",value:(u=O()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return cozy.client.files.trashById(t.id),e.abrupt("return",{data:[t]});case 2:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"fetchReferencedFiles",value:(s=O()(w.a.mark((function e(t){var n,r,o,c,i,a=arguments;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,r=N()({},t,{_id:t.id}),e.next=4,cozy.client.data.fetchReferencedFiles(r,{skip:n,limit:50});case 4:return o=e.sent,c=o.included,i=o.meta,e.abrupt("return",{data:c?c.map((function(e){return N()({},e,e.attributes,{_type:"io.cozy.files"})})):[],meta:i,next:i.count>n+50,skip:n});case 8:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"fetchKonnectors",value:(a=O()(w.a.mark((function e(){var t,n,r,o,c=arguments;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:0,e.next=3,cozy.client.fetchJSON("GET","/konnectors/",null,{processJSONAPI:!1});case 3:return n=e.sent,r=n.data,o=n.meta,e.abrupt("return",{data:r?r.map((function(e){return N()({},e,e.attributes,{_type:"io.cozy.konnectors"})})):[],meta:o,skip:t,next:!!o&&o.count>t+50});case 7:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"fetchTriggers",value:(c=O()(w.a.mark((function e(t){var n,r,o,c,i=arguments;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:0,e.next=3,cozy.client.fetchJSON("GET","/jobs/triggers?Worker=".concat(t),null,{processJSONAPI:!1});case 3:return r=e.sent,o=r.data,c=r.meta,e.abrupt("return",{data:o?o.map((function(e){return N()({},e,e.attributes,{_type:"io.cozy.triggers"})})):[],meta:c,skip:n,next:!!c&&c.count>n+50});case 7:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"addReferencedFiles",value:(r=O()(w.a.mark((function e(t,n){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cozy.client.data.addReferencedFiles(t,n);case 2:return e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"removeReferencedFiles",value:(n=O()(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=N()({},t,{_id:t.id}),e.next=3,cozy.client.data.removeReferencedFiles(r,n);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetchSharingPermissions",value:(t=O()(w.a.mark((function e(t){var n,r,o,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e,t){return cozy.client.fetchJSON("GET","/permissions/doctype/".concat(e,"/").concat(t))},e.next=3,n(t,"sharedWithOthers");case 3:return r=e.sent,e.next=6,n(t,"sharedByLink");case 6:return o=e.sent,e.next=9,n(t,"sharedWithMe");case 9:return c=e.sent,e.abrupt("return",{byMe:r,byLink:o,withMe:c});case 11:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"fetchSharing",value:function(e){return cozy.client.fetchJSON("GET","/sharings/".concat(e))}},{key:"createSharing",value:function(e,t,n,r){return cozy.client.fetchJSON("POST","/sharings/",{desc:r,permissions:e,recipients:t.map((function(e){return{recipient:{id:e,type:"io.cozy.contacts"}}})),sharing_type:n})}},{key:"revokeSharing",value:function(e){return cozy.client.fetchJSON("DELETE","/sharings/".concat(e))}},{key:"revokeSharingForClient",value:function(e,t){return cozy.client.fetchJSON("DELETE","/sharings/".concat(e,"/recipient/").concat(t))}},{key:"createSharingLink",value:function(e){return cozy.client.fetchJSON("POST","/permissions?codes=email",{data:{type:"io.cozy.permissions",attributes:{permissions:e}}})}},{key:"revokeSharingLink",value:function(e){return cozy.client.fetchJSON("DELETE","/permissions/".concat(e._id))}}]),e}(),z=function(e){return N()({},e,e.attributes,{id:e._id})},R={syncStatus:"pending",lastSync:null,seqNumber:0},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_DOCTYPE_SYNC":return N()({},e,{syncStatus:"syncing",seqNumber:t.seqNumber});case"SYNC_DOCTYPE_OK":return N()({},e,{syncStatus:"done",lastSync:Date.now()});case"SYNC_DOCTYPE_ERROR":return N()({},e,{syncStatus:"error",lastSync:Date.now()});default:return e}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_DOCTYPE_SYNC":case"SYNC_DOCTYPE_OK":case"SYNC_DOCTYPE_ERROR":return N()({},e,h()({},t.doctype,I(e[t.doctype],t)));default:return e}},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{type:"START_DOCTYPE_SYNC",doctype:e,seqNumber:t}},j=function(e,t){return{type:"SYNC_DOCTYPE_OK",doctype:e,infos:t}},U=function(e,t){return{type:"SYNC_DOCTYPE_ERROR",doctype:e,error:t}},M=function(){function e(){o()(this,e),PouchDB.plugin(pouchdbFind),this.instances={},this.doctypes=[]}var t,n,r,c,a,s,u;return i()(e,[{key:"registerDoctypes",value:function(e){this.doctypes=e}},{key:"getDatabase",value:function(e){return cozy.client.offline.getDatabase(e)}},{key:"getReplicationBaseUrl",value:function(){return cozy.client.authorize().then((function(e){var t=e.token.toBasicAuth();return"".concat(cozy.client._url,"/data/").replace("//","//".concat(t))}))}},{key:"getSeqNumber",value:function(e){return this.getDatabase(e).info().then((function(e){return e.update_seq}))}},{key:"sync",value:(u=O()(w.a.mark((function e(t){var n,r,o,c,i,a,s,u,l,d=arguments;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:"SYNC_BIDIRECTIONAL",e.next=3,this.getReplicationBaseUrl();case 3:r=e.sent,o=!0,c=!1,i=void 0,e.prev=7,a=this.doctypes[Symbol.iterator]();case 9:if(o=(s=a.next()).done){e.next=20;break}return u=s.value,e.next=13,this.getSeqNumber(u);case 13:return l=e.sent,e.next=16,t(L(u,l));case 16:this.syncDoctype(u,"".concat(r).concat(u),t,n);case 17:o=!0,e.next=9;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(7),c=!0,i=e.t0;case 26:e.prev=26,e.prev=27,o||null==a.return||a.return();case 29:if(e.prev=29,!c){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(26);case 34:case"end":return e.stop()}}),e,this,[[7,22,26,34],[27,,29,33]])}))),function(e){return u.apply(this,arguments)})},{key:"syncDoctype",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"SYNC_BIDIRECTIONAL";return new Promise((function(c,i){var a=r.getDatabase(e);("SYNC_TO"===o?a.replicate.to(t):"SYNC_FROM"===o?a.replicate.from(t):a.sync(t)).on("complete",(function(i){n(j(e,i)),r.scheduleNextSync(e,t,n,o),c(i)})).on("error",(function(o){if("code=400, message=Expired token"===o.error)return cozy.client.authorize().then((function(n){var o=n.client,c=n.token;cozy.client.auth.refreshToken(cozy,o,c).then((function(e){return cozy.client.saveCredentials(o,e)})).then((function(){return r.syncDoctype(e,t)}))}));404!==o.status&&(n(U(e,o)),r.scheduleNextSync(e,t,n),i(o))}))}))}},{key:"scheduleNextSync",value:function(e,t,n,r){var o=this;setTimeout((function(){o.syncDoctype(e,t,n,r)}),3e4)}},{key:"fetchDocuments",value:(s=O()(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDatabase(t).allDocs({include_docs:!0});case 2:return n=e.sent,e.abrupt("return",{data:n.rows.filter((function(e){return!e.doc.hasOwnProperty("views")})).map((function(e){return N()({},e.doc,{id:e.id,_type:t})})),meta:{count:n.total_rows},skip:n.offset,next:!1});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"queryDocuments",value:(a=O()(w.a.mark((function e(t,n,r){var o,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=N()({},r,{fields:[].concat(k()(r.fields),["_id"]),sort:r.sort?Object.keys(r.sort).map((function(e){return h()({},e,r.sort[e])})):void 0}),e.next=3,this.getDatabase(t).find(o);case 3:return c=e.sent,e.abrupt("return",{data:c.docs.map((function(e){return N()({},e,{id:e._id,_type:t})})),meta:{count:c.docs.length},skip:0,next:!1});case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"fetchDocument",value:(c=O()(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDatabase(t).get(n,{revs_info:!0});case 2:return r=e.sent,e.abrupt("return",{data:[N()({},r,{id:r.id,_id:r.id,_type:t})]});case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"createDocument",value:(r=O()(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDatabase(t).post(n);case 2:return r=e.sent,e.abrupt("return",{data:[N()({},n,{id:r.id,_id:r.id,_type:t,_rev:r.rev})]});case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"updateDocument",value:(n=O()(w.a.mark((function e(t){var n,r,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._type,r=D()(t,["_type"]),e.next=3,this.getDatabase(n).put(r);case 3:return o=e.sent,e.abrupt("return",{data:[N()({},t,{_rev:o.rev})]});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"deleteDocument",value:(t=O()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDatabase(t._type).remove(t);case 2:return e.abrupt("return",{data:[t]});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"createIndex",value:function(e,t){return this.getDatabase(e).createIndex({index:{fields:t}})}},{key:"fetchFileByPath",value:function(){throw new Error("Not implemented")}},{key:"createFile",value:function(){throw new Error("Not implemented")}},{key:"trashFile",value:function(){throw new Error("Not implemented")}},{key:"fetchReferencedFiles",value:function(){throw new Error("Not implemented")}},{key:"addReferencedFiles",value:function(){throw new Error("Not implemented")}},{key:"removeReferencedFiles",value:function(){throw new Error("Not implemented")}}]),e}(),F=function(){function e(){o()(this,e),this.stackAdapter=new S,"undefined"!=typeof PouchDB?(this.pouchAdapter=new M,this.strategy=new P):this.strategy=new V}return i()(e,[{key:"setup",value:function(e,t){var n=N()({cozyURL:e},t);cozy.client.init(n),this.stackAdapter.init(n),n.offline&&this.pouchAdapter.registerDoctypes(n.offline.doctypes)}},{key:"getAdapter",value:function(e){return this.strategy.getAdapter(e,this.stackAdapter,this.pouchAdapter)}},{key:"startSync",value:function(e){return this.pouchAdapter.sync(e,"SYNC_BIDIRECTIONAL")}},{key:"startReplicationTo",value:function(e){return this.pouchAdapter.sync(e,"SYNC_TO")}},{key:"startReplicationFrom",value:function(e){return this.pouchAdapter.sync(e,"SYNC_FROM")}}]),e}(),P=function(){function e(){o()(this,e)}return i()(e,[{key:"getAdapter",value:function(e,t,n){return void 0===n.getDatabase(e)?t:n}}]),e}(),V=function(){function e(){o()(this,e)}return i()(e,[{key:"getAdapter",value:function(e,t){return t}}]),e}(),Y=function(e){return void 0!==window.cordova&&void 0!==window.cordova.InAppBrowser?new Promise((function(t,n){var r=window.cordova.InAppBrowser.open(e,"_blank","clearcache=yes,zoom=no"),o=function(){r.removeEventListener("loadstart",c),r.removeEventListener("exit",i)},c=function(e){var n=e.url,c=/\?access_code=(.+)$/.test(n),i=/\?state=(.+)$/.test(n);(c||i)&&(t(n),o(),r.close())},i=function(){n(new Error("REGISTRATION_ABORT")),o(),r.close()};r.addEventListener("loadstart",c),r.addEventListener("exit",i)})):new Promise((function(e){setTimeout((function(){var t=prompt("Paste the url here:");e(t)}),1e4)}))},q=function(){function e(t){o()(this,e);var n=t.cozyURL,r=D()(t,["cozyURL"]);this.options=r,this.indexes={},this.specialDirectories={},this.facade=new F,n&&this.facade.setup(n,r)}var t,n,r,c,a,s,u,l;return i()(e,[{key:"register",value:function(e){return this.facade.setup(e,N()({},this.options,{oauth:N()({},this.options.oauth,{onRegistered:function(e,t){return Y(t)}})})),cozy.client.authorize(!0)}},{key:"isRegistered",value:(l=O()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,cozy.client.auth.getClient(t);case 5:return e.abrupt("return",!0);case 8:if(e.prev=8,e.t0=e.catch(2),"Failed to fetch"!==e.t0.message){e.next=14;break}return e.abrupt("return",!0);case 14:return console.warn(e.t0),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[2,8]])}))),function(e){return l.apply(this,arguments)})},{key:"startSync",value:function(e){return this.facade.startSync(e)}},{key:"startReplicationTo",value:function(e){return this.facade.startReplicationTo(e)}},{key:"startReplicationFrom",value:function(e){return this.facade.startReplicationFrom(e)}},{key:"getAdapter",value:function(e){return this.facade.getAdapter(e)}},{key:"fetchApps",value:(u=O()(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getAdapter("io.cozy.apps").fetchApps());case 1:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"fetchCollection",value:(s=O()(w.a.mark((function e(t,n){var r,o,c,i=arguments;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]?i[2]:{},o=i.length>3&&void 0!==i[3]?i[3]:0,!r.selector){e.next=7;break}return e.next=5,this.getCollectionIndex(t,n,r);case 5:return c=e.sent,e.abrupt("return",this.getAdapter(n).queryDocuments(n,c,N()({},r,{skip:o})));case 7:return e.abrupt("return",this.getAdapter(n).fetchDocuments(n));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"fetchDocument",value:function(e,t){return this.getAdapter(e).fetchDocument(e,t)}},{key:"fetchFile",value:function(e){return this.getAdapter("io.cozy.files").fetchFile(e)}},{key:"fetchReferencedFiles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getAdapter(e._type).fetchReferencedFiles(e,t)}},{key:"fetchTriggers",value:function(e,t){return this.getAdapter("io.cozy.triggers").fetchTriggers(t)}},{key:"fetchKonnectors",value:function(){return this.getAdapter("io.cozy.konnectors").fetchKonnectors()}},{key:"addReferencedFiles",value:function(e,t){return this.getAdapter(e._type).addReferencedFiles(e,t)}},{key:"removeReferencedFiles",value:function(e,t){return this.getAdapter(e._type).removeReferencedFiles(e,t)}},{key:"createDocument",value:function(e,t){return this.getAdapter(e).createDocument(e,t)}},{key:"createTrigger",value:function(e){return this.getAdapter(e._type).createTrigger(e)}},{key:"launchTrigger",value:function(e){return this.getAdapter(e._type).launchTrigger(e)}},{key:"updateDocument",value:function(e){return this.getAdapter(e._type).updateDocument(e)}},{key:"deleteDocument",value:function(e){return this.getAdapter(e._type).deleteDocument(e)}},{key:"deleteTrigger",value:function(e){return this.getAdapter(e._type).deleteTrigger(e)}},{key:"fetchSharings",value:(a=O()(w.a.mark((function e(t){var n,r,o,c=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAdapter(t).fetchSharingPermissions(t);case 2:return n=e.sent,r=[].concat(k()(n.byMe.map((function(e){return e.attributes.source_id}))),k()(n.withMe.map((function(e){return e.attributes.source_id})))),e.next=6,Promise.all(r.map((function(e){return c.getAdapter("io.cozy.sharings").fetchSharing(e)})));case 6:return o=e.sent,e.abrupt("return",{permissions:n,sharings:o});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"createSharing",value:function(e,t,n,r){return this.getAdapter("io.cozy.sharings").createSharing(e,t,n,r)}},{key:"revokeSharing",value:function(e){return this.getAdapter("io.cozy.sharings").revokeSharing(e)}},{key:"revokeSharingForClient",value:function(e,t){return this.getAdapter("io.cozy.sharings").revokeSharingForClient(e,t)}},{key:"createSharingLink",value:function(e){return this.getAdapter("io.cozy.sharings").createSharingLink(e)}},{key:"revokeSharingLink",value:function(e){return this.getAdapter("io.cozy.sharings").revokeSharingLink(e)}},{key:"createFile",value:function(e,t){return this.getAdapter("io.cozy.files").createFile(e,t)}},{key:"trashFile",value:function(e){return this.getAdapter("io.cozy.files").trashFile(e)}},{key:"ensureDirectoryExists",value:(c=O()(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.specialDirectories[t]){e.next=5;break}return e.next=3,cozy.client.files.createDirectoryByPath(t);case 3:n=e.sent,this.specialDirectories[t]=n._id;case 5:return e.abrupt("return",this.specialDirectories[t]);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"checkUniquenessOf",value:(r=O()(w.a.mark((function e(t,n,r){var o,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getUniqueIndex(t,n);case 2:return o=e.sent,e.next=5,cozy.client.data.query(o,{selector:h()({},n,r),fields:["_id"]});case 5:return c=e.sent,e.abrupt("return",0===c.length);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"getCollectionIndex",value:(n=O()(w.a.mark((function e(t,n,r){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.indexes[t]){e.next=4;break}return e.next=3,this.getAdapter(n).createIndex(n,this.getIndexFields(r));case 3:this.indexes[t]=e.sent;case 4:return e.abrupt("return",this.indexes[t]);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"getUniqueIndex",value:(t=O()(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="".concat(t,"/").concat(n),this.indexes[r]){e.next=5;break}return e.next=4,this.getAdapter(t).createIndex(t,[n]);case 4:this.indexes[r]=e.sent;case 5:return e.abrupt("return",this.indexes[r]);case 6:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getIndexFields",value:function(e){var t=e.selector,n=e.sort;return n?[].concat(k()(Object.keys(t)),k()(Object.keys(n))).filter((function(e,t,n){return n.indexOf(e)===t})):Object.keys(t)}}]),e}(),H=n("/MKj"),G=function(e,t){var n={};for(var r in e)n[r]=t(e[r],r);return n},B=function(e,t){var n={};for(var r in e)t(e[r],r)&&(n[r]=e[r]);return n},K=function(e,t){return Object.keys(e).reduce((function(n,r){return r!==t&&(n[r]=e[r]),n}),{})},W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n){var r=function(e){function t(){return o()(this,t),s()(this,l()(t).apply(this,arguments))}return p()(t,e),i()(t,[{key:"componentDidMount",value:function(){var e=this.props.fetchActions,t=this.context.store.dispatch;for(var n in e)t(e[n])}},{key:"render",value:function(){var e=this.context.store,t=this.props.fetchActions,r=N()({},this.props,we(this.props,t,e.dispatch));return m.a.createElement(n,r)}}]),t}(y.Component);h()(r,"contextTypes",{store:v.a.object});return Object(H.connect)((function(t,n){var r=e(n),o=function(e){return e&&e.types&&e.promise},c=B(r,(function(e){return o(e)})),i=B(r,(function(e){return!o(e)}));return function(e){return N()({},G(c,(function(t){return o(t)?_e(e,t):t})),{fetchActions:c},i)}}),t)(r)}},J=n("J4zp"),Z=n.n(J),X=function(e){return function(t){var n=t.dispatch;return function(t){return function(r){var o=r.promise,c=r.type,i=r.types,a=D()(r,["promise","type","types"]);if(!o)return t(r);if(!c&&!i)return o(e).then((function(e){return n(e)}));if(c)return o(e).then((function(e){return t(N()({},a,{response:e,type:c})),e}));var s=Z()(i,3),u=s[0],l=s[1],d=s[2];return t(N()({},a,{type:u})),o(e).then((function(e){return t(N()({},a,{response:e,type:l})),e}),(function(e){console.log(e),t(N()({},a,{error:e,type:d}))})).catch((function(e){console.error("MIDDLEWARE ERROR:",e),t(N()({},a,{error:e,type:d}))}))}}}},Q=n("fvjX"),$=(n("4kcP"),function(e,t){var n=e.findIndex((function(e){return e.recipient.id===t}));return[].concat(k()(e.slice(0,n)),k()(e.slice(n+1)))}),ee={fetchStatus:"loading",byMe:[],byLink:[],withMe:[]},te=Object(Q.combineReducers)({documents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_SHARINGS_DATA":return t.response.sharings;case"RECEIVE_NEW_SHARING":return[].concat(k()(e),[t.response]);case"RECEIVE_SHARING_REVOKE":var n=e.findIndex((function(e){return e.attributes.sharing_id===t.sharingId}));if(-1===n)return e;var r=e[n],o=void 0===r.attributes.recipients||1===r.attributes.recipients.length,c=o?N()({},r,{attributes:N()({},r.attributes,{revoked:!0})}):N()({},r,{attributes:N()({},r.attributes,{recipients:$(r.attributes.recipients,t.recipientId)})});return[].concat(k()(e.slice(0,n)),[c],k()(e.slice(n+1)));default:return e}},permissions:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"FETCH_SHARINGS":return t[n.doctype]?N()({},t,h()({},n.doctype,N()({},t[n.doctype],{fetchStatus:"loading"}))):N()({},t,h()({},n.doctype,ee));case"RECEIVE_SHARINGS_DATA":return N()({},t,h()({},n.doctype,N()({fetchStatus:"loaded"},n.response.permissions)));case"RECEIVE_FETCH_SHARINGS_ERROR":return N()({},t,h()({},n.doctype,{fetchStatus:"error"}));case"RECEIVE_NEW_SHARING":return N()({},t,h()({},n.doctype,N()({},t[n.doctype],{byMe:[].concat(k()(t[n.doctype].byMe),[{attributes:{permissions:{rule0:{type:n.doctype,values:[n.id]}},source_id:n.response.attributes.sharing_id,type:"io.cozy.sharings"}}])})));case"RECEIVE_NEW_SHARING_LINK":return N()({},t,h()({},n.doctype,N()({},t[n.doctype],{byLink:[].concat(k()(t[n.doctype].byLink),[n.response])})));case"REVOKE_SHARING_LINK":return-1===(e=t[n.doctype].byLink.findIndex((function(e){return n.permission._id===e._id})))?t:N()({},t,h()({},n.doctype,N()({},t[n.doctype],{byLink:[].concat(k()(t[n.doctype].byLink.slice(0,e)),k()(t[n.doctype].byLink.slice(e+1)))})));default:return t}}}),ne=function(e,t){return Oe(e,"io.cozy.contacts",t)},re=function(e,t){return e.cozy.sharings.permissions[t]?e.cozy.sharings.permissions[t]:ee},oe=function(e,t,n){var r=re(e,t),o=ue({_type:t})?"files":"collection";return r.byLink.find((function(e){return-1!==e.attributes.permissions[o].values.indexOf(n)}))},ce=function(e,t,n){var r=re(e,t);return[].concat(k()(r.byMe.filter((function(e){return-1!==e.attributes.permissions.rule0.values.indexOf(n)}))),k()(r.withMe.filter((function(e){return-1!==e.attributes.permissions.rule0.values.indexOf(n)})))).map((function(t){return function(e,t){return e.cozy.sharings.documents.find((function(e){return e.attributes.sharing_id===t}))}(e,t.attributes.source_id)})).filter((function(e){return!e.attributes.revoked}))},ie=function(e,t,n){var r=function(e,t,n){var r=ce(e,t,n);return{shared:0!==r.length,owner:0===r.length||r.some((function(e){return!0===e.attributes.owner})),sharingType:r.some((function(e){return"master-master"===e.attributes.sharing_type}))?"master-master":"master-slave",sharings:r}}(e,t,n),o=r.shared,c=r.owner,i=r.sharingType,a=r.sharings,s=function(e,t,n){var r=oe(e,t,n);return r?se(n,t,r.attributes.codes.email):null}(e,t,n);return{shared:o,owner:c,sharingType:i,sharingLink:s,sharer:o&&!c?{name:"John Doe",url:a[0].attributes.sharer.url}:null,readOnly:!c&&"master-slave"===i,recipients:o&&c?ae(e,a):[],byMe:o&&!0===c,withMe:o&&!c,byLink:!!s}},ae=function(e,t){return t.filter((function(e){return e.attributes.recipients})).map((function(t){return t.attributes.recipients.map((function(n){return{contact:ne(e,n.recipient.id),status:n.status,type:t.attributes.sharing_type}}))})).reduce((function(e,t){return e.concat(t)}),[])},se=function(e,t,n){return"".concat(window.location.origin,"/public?sharecode=").concat(n,"&id=").concat(e).concat("file"===t?"&directdownload":"")},ue=function(e){var t=e._type,n=e.type;return"io.cozy.files"===t||"directory"===n||"file"===n},le="RECEIVE_DATA",de=function(e){return e.reduce((function(e,t){return N()({},e,h()({},t.id,t))}),{})},pe=function(e,t,n){return t.reduce((function(t,r){return N()({},t,h()({},r,function(e,t){var n=e.relationships,r=n.referenced_by,o=D()(n,["referenced_by"]),c=D()(e,["relationships"]);return N()({},c,{relationships:N()({},o,h()({},r.data,null===r.data?[{id:t.id,type:t.type}]:[].concat(k()(r.data),[{id:t.id,type:t.type}])))})}(e[r],n)))}),{})},fe=function(e,t,n){return t.reduce((function(t,r){return N()({},t,h()({},r,function(e,t){var n=e.relationships,r=n.referenced_by,o=D()(n,["referenced_by"]),c=D()(e,["relationships"]);return N()({},c,{relationships:N()({},o,h()({},r.data,r.data.filter((function(e){return e.type!==t.type&&e.id!==t.id}))))})}(e[r],n)))}),{})},he=function(e){return t=e[0],"file"===(n=t._type)?"io.cozy.files":n;var t,n},ye={type:null,options:{},fetchStatus:"pending",lastFetch:null,hasMore:!1,count:0,ids:[]},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_COLLECTION":case"FETCH_REFERENCED_FILES":return N()({},e,{type:t.doctype||"io.cozy.files",options:t.options,fetchStatus:t.skip>0?"loadingMore":"loading"});case"RECEIVE_APP":case le:var n=t.response;return N()({},e,{fetchStatus:"loaded",lastFetch:Date.now(),hasMore:void 0!==n.next?n.next:e.hasMore,count:n.meta&&n.meta.count?n.meta.count:n.data.length,ids:t.skip?[].concat(k()(e.ids),k()(n.data.map((function(e){return e.id})))):n.data.map((function(e){return e.id}))});case"ADD_REFERENCED_FILES":return N()({},e,{type:"io.cozy.files",count:e.count+t.ids.length,ids:[].concat(k()(e.ids),k()(t.ids))});case"REMOVE_REFERENCED_FILES":return N()({},e,{count:e.count-t.ids.length,ids:e.ids.filter((function(e){return-1===t.ids.indexOf(e)}))});case"RECEIVE_ERROR":return N()({},e,{fetchStatus:"failed"});case"RECEIVE_NEW_DOCUMENT":return N()({},e,{ids:[].concat(k()(e.ids),[t.response.data[0].id])});case"RECEIVE_DELETED_DOCUMENT":return N()({},e,{ids:e.ids.filter((function(e){return e!==t.response.data[0].id}))});default:return e}},ge=Object(Q.combineReducers)({collections:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=function(e,n){return n.updateCollections.reduce((function(n,r){return N()({},n,h()({},r,me(e[r],t)))}),{})};switch(t.type){case"FETCH_COLLECTION":case"FETCH_REFERENCED_FILES":case"ADD_REFERENCED_FILES":case"REMOVE_REFERENCED_FILES":case"RECEIVE_APP":case le:case"RECEIVE_ERROR":return t.collection?N()({},e,h()({},t.collection,me(e[t.collection],t))):e;case"RECEIVE_NEW_DOCUMENT":case"RECEIVE_DELETED_DOCUMENT":return t.updateCollections?N()({},e,n(e,t)):e;default:return e}},documents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_APP":var n=t.response&&t.response.data;return 0===n.length?e:N()({},e,h()({},"io.cozy.apps",N()({},e["io.cozy.apps"],de(n))));case le:var r=t.response.data;if(0===r.length)return e;var o=he(r);return N()({},e,h()({},o,N()({},e[o],de(r))));case"RECEIVE_NEW_DOCUMENT":case"RECEIVE_UPDATED_DOCUMENT":var c=t.response.data[0];return N()({},e,h()({},c._type,N()({},e[c._type],h()({},c.id,c))));case"RECEIVE_DELETED_DOCUMENT":var i=t.response.data[0];return N()({},e,h()({},i._type,K(e[i._type],i.id)));case"ADD_REFERENCED_FILES":return N()({},e,{"io.cozy.files":N()({},e["io.cozy.files"],pe(e["io.cozy.files"],t.ids,t.document))});case"REMOVE_REFERENCED_FILES":return N()({},e,{"io.cozy.files":N()({},e["io.cozy.files"],fe(e["io.cozy.files"],t.ids,t.document))});default:return e}},sharings:te,synchronization:A}),ve=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{types:["FETCH_COLLECTION",le,"RECEIVE_ERROR"],collection:e,doctype:t,options:n,skip:r,promise:function(o){return o.fetchCollection(e,t,n,r)}}},Ee=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{types:["FETCH_COLLECTION",le,"RECEIVE_ERROR"],collection:e,doctype:"io.cozy.triggers",options:n,skip:r,promise:function(o){return o.fetchTriggers(e,t,n,r)}}},be=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{types:["FETCH_COLLECTION",le,"RECEIVE_ERROR"],collection:e,doctype:"io.cozy.konnectors",options:t,skip:n,promise:function(r){return r.fetchKonnectors(e,t,n)}}},ke=function(e,t){var n=e.types,r=e.collection,o=e.document,c=e.doctype,i=e.options;return"FETCH_REFERENCED_FILES"===n[0]?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{types:["FETCH_REFERENCED_FILES",le,"RECEIVE_ERROR"],collection:"".concat(e._type,"/").concat(e.id,"#files"),document:e,options:{},skip:t,promise:function(n){return n.fetchReferencedFiles(e,t)}}}(o,t):ve(r,c,i,t)},_e=function(e,t){switch(t.types[0]){case"FETCH_COLLECTION":case"FETCH_REFERENCED_FILES":return Ce(e,t.collection);case"FETCH_DOCUMENT":return Oe(e,t.doctype,t.id);case"FETCH_SHARINGS":return t.id?ie(e,t.doctype,t.id,t.options):function(e,t){var n=re(e,t),r="io.cozy.files"===t?"files":"collection";return{byMe:n.byMe.map((function(e){return e.attributes.permissions.rule0.values[0]})),withMe:n.withMe.map((function(e){return e.attributes.permissions.rule0.values[0]})),byLink:n.byLink.map((function(e){return e.attributes.permissions[r].values[0]}))}}(e,t.doctype,t.options);default:return null}},we=function(e,t,n){return G(t,(function(t,r){var o=e[r];switch(t.types[0]){case"FETCH_COLLECTION":case"FETCH_REFERENCED_FILES":return N()({},o,{fetchMore:o.hasMore?function(){return n(ke(t,o.data.length))}:null});default:return o}}))},Ce=function(e,t){var n,r,o,c=e.cozy.collections[t];return c?N()({},c,{data:(n=e.cozy.documents,r=c.type,o=c.ids,o.map((function(e){return n[r][e]})))}):N()({},ye,{data:null})},Oe=function(e,t,n){var r=e.cozy.documents[t];return r?r[n]:null};n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return q})),n.d(t,"d",(function(){return W})),n.d(t,"e",(function(){return X})),n.d(t,"j",(function(){return ge})),n.d(t,"g",(function(){return ve})),n.d(t,"h",(function(){return be})),n.d(t,"i",(function(){return Ee})),n.d(t,"c",(function(){return _e})),n.d(t,"f",(function(){return we}))},mD6Q:function(e,t,n){"use strict";var r=n("m+TH"),o=n("3dAU"),c=n("uZd2"),i=n("sR/t"),a=n("rGvZ"),s=n("kdbL");n.n(s)()("harvest.bi-konnector-policy",!0);var u=function(){return{accounts:Object(o.a)(),jobs:Object(i.a)(),konnectors:Object(c.a)(),triggers:Object(a.a)()}};t.a=function(e,t){return Object(r.d)(u)(e,t)}},rGvZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n("m+TH"),o="io.cozy.triggers",c=function(){return r.i("triggers","konnector")},i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return!!e.documents[o]&&Object.values(e.documents[o]).filter((function(e){return"konnector"===e.worker&&e.message&&e.message.konnector===t.slug&&e.message.account&&n.includes(e.message.account)}))||[]},a=function(e,t){return!!e.documents&&!!e.documents[o]&&e.documents[o][t]}},"sR/t":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i}));var r=n("NAv5"),o=n.n(r),c=function(){},i=function(e,t){return e.documents&&e.documents["io.cozy.jobs"]&&t?Object.values(e.documents["io.cozy.jobs"]).reduce((function(e,n){return n.trigger_id!==t._id?e:e?o.a.isAfter(n.started_at,e.started_at)?n:e:n}),null):null}},uZd2:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return p}));var r=n("MVZn"),o=n.n(r),c=n("m+TH"),i="io.cozy.konnectors",a=function(){return c.h("konnectors")},s=function(e){var t=o()({},e,e.attributes,{id:"".concat(i,"/").concat(e.slug),_type:i});return{doctype:i,type:"RECEIVE_NEW_DOCUMENT",response:{data:[t]},updateCollections:["konnectors"]}},u=function(e,t){return!!e.documents&&!!e.documents[i]&&e.documents[i]["".concat(i,"/").concat(t)]},l=function(e){return!!e.documents&&!!e.documents[i]&&Object.values(e.documents[i])},d=function(e){return!!e.documents&&!!e.documents[i]&&Object.keys(e.documents[i]).reduce((function(t,n){var r=e.documents[i][n];return t[r.slug]=r,t}),{})},p=function(e){return!!e&&!!e.documents&&!!e.documents[i]&&Object.values(e.documents[i]).map((function(e){return e.slug}))}},vL8P:function(e,t){e.exports="/img/connecting-data-in-progress.55926c8c7c5dd75908e58b2e81fd2881.svg"},yMTE:function(e,t,n){var r={"./en":"Us+F","./en/":"Us+F","./en/build_distance_in_words_locale":"LZbM","./en/build_distance_in_words_locale/":"LZbM","./en/build_distance_in_words_locale/index":"LZbM","./en/build_distance_in_words_locale/index.js":"LZbM","./en/build_format_locale":"6DAA","./en/build_format_locale/":"6DAA","./en/build_format_locale/index":"6DAA","./en/build_format_locale/index.js":"6DAA","./en/index":"Us+F","./en/index.d.ts":"DYsx","./en/index.js":"Us+F","./en/package":"EJIZ","./en/package.json":"EJIZ","./es":"/S0t","./es/":"/S0t","./es/build_distance_in_words_locale":"GEfZ","./es/build_distance_in_words_locale/":"GEfZ","./es/build_distance_in_words_locale/index":"GEfZ","./es/build_distance_in_words_locale/index.js":"GEfZ","./es/build_format_locale":"O+zC","./es/build_format_locale/":"O+zC","./es/build_format_locale/index":"O+zC","./es/build_format_locale/index.js":"O+zC","./es/index":"/S0t","./es/index.d.ts":"gbHe","./es/index.js":"/S0t","./es/package":"Vizl","./es/package.json":"Vizl","./fr":"LKA2","./fr/":"LKA2","./fr/build_distance_in_words_locale":"IzMR","./fr/build_distance_in_words_locale/":"IzMR","./fr/build_distance_in_words_locale/index":"IzMR","./fr/build_distance_in_words_locale/index.js":"IzMR","./fr/build_format_locale":"I3Zg","./fr/build_format_locale/":"I3Zg","./fr/build_format_locale/index":"I3Zg","./fr/build_format_locale/index.js":"I3Zg","./fr/index":"LKA2","./fr/index.d.ts":"hE7Q","./fr/index.js":"LKA2","./fr/package":"herc","./fr/package.json":"herc"};function o(e){var t=c(e);return n(t)}function c(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=c,e.exports=o,o.id="yMTE"}});